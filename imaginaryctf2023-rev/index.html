<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>ImaginaryCTF 2023 - Reverse Engineering Writeups - FazeCT Blogs</title><meta name=Description content="Solutions to some reverse engineering challenges in the event."><meta property="og:title" content="ImaginaryCTF 2023 - Reverse Engineering Writeups">
<meta property="og:description" content="Solutions to some reverse engineering challenges in the event."><meta property="og:type" content="article"><meta property="og:url" content="https://fazect.github.io/imaginaryctf2023-rev/"><meta property="og:image" content="https://fazect.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-24T02:05:00+07:00"><meta property="article:modified_time" content="2023-07-24T02:05:00+07:00"><meta property="og:site_name" content="FazeCT blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fazect.github.io/logo.png"><meta name=twitter:title content="ImaginaryCTF 2023 - Reverse Engineering Writeups"><meta name=twitter:description content="Solutions to some reverse engineering challenges in the event."><meta name=application-name content="CTF Blogs"><meta name=apple-mobile-web-app-title content="CTF Blogs"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://fazect.github.io/imaginaryctf2023-rev/><link rel=prev href=https://fazect.github.io/amateursctf2023-rev/><link rel=next href=https://fazect.github.io/sekaictf2023-sfc/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ImaginaryCTF 2023 - Reverse Engineering Writeups","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/fazect.github.io\/imaginaryctf2023-rev\/"},"genre":"posts","keywords":"RE, ImaginaryCTF, english","wordcount":6025,"url":"https:\/\/fazect.github.io\/imaginaryctf2023-rev\/","datePublished":"2023-07-24T02:05:00+07:00","dateModified":"2023-07-24T02:05:00+07:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"FazeCT"},"description":"Solutions to some reverse engineering challenges in the event."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="FazeCT Blogs">Blogs</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/aboutme/>About Me </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="FazeCT Blogs">Blogs</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/aboutme/ title>About Me</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ImaginaryCTF 2023 - Reverse Engineering Writeups</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://fazect.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>FazeCT</a>
</span>&nbsp;<span class=post-category>included in <a href=/categories/writeups/><i class="far fa-folder fa-fw" aria-hidden=true></i>Writeups</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-07-24>2023-07-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;6025 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;29 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#chaos>chaos</a></li><li><a href=#snailchecker>snailchecker</a></li><li><a href=#scrambled>scrambled</a></li><li><a href=#sheepish>Sheepish</a></li><li><a href=#vmcastle>vmcastle</a></li><li><a href=#typechecker>Typechecker</a></li><li><a href=#appendix>Appendix</a></li></ul></nav></div></div><div class=content id=content><p>Solutions to some reverse engineering challenges in the event.</p><h2 id=overview>Overview</h2><p>Last weekend, I participated in the event with my team, <code>thehackerscrew</code>, and we finished at rank <code>5/878</code>. Was really hoping that we could get the last banger from a crypto challenge to bring us <code>4th</code>, but we couldn&rsquo;t make it.</p><img src=scores.png alt width=1000><p>For reverse engineering, we did <code>6/8</code> challenges.</p><p>All of the challenges&rsquo; binaries can be found here: <a href=https://github.com/FazeCT/ctf/tree/main/imaginaryCTF%202023 target=_blank rel="noopener noreffer">Click me!</a></p><h2 id=chaos>chaos</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>chall.py</code></li><li><strong>Description:</strong> Can you find order in the midst of chaos?</li></ul></div></div></div><p>For this challenge, we are given a Python source with an one-liner checker. Even though it seems to be heavily obfuscated, we can still see some really interesting parts, one of which is shown below.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span> <span class=k>if</span> <span class=s2>&#34;rni&#34;</span> <span class=ow>in</span> <span class=n>n</span><span class=o>.</span><span class=vm>__name__</span> <span class=ow>and</span> <span class=n>n</span><span class=o>.</span><span class=vm>__name__</span> <span class=o>==</span> <span class=n>n</span><span class=o>.</span><span class=vm>__name__</span><span class=o>.</span><span class=n>lower</span><span class=p>()][</span><span class=mi>0</span><span class=p>]()</span><span class=o>.</span><span class=n>_module</span><span class=o>.</span><span class=n>__builtins__</span><span class=o>.</span><span class=fm>__getitem__</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\x62\x79\x74\x65\x73</span><span class=s2>&#34;</span><span class=p>),</span><span class=s2>&#34;</span><span class=se>\x36\x39\x20\x36\x65\x20\x37\x30</span><span class=s2>&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span><span class=o>.</span><span class=fm>__getitem__</span><span class=p>(</span><span class=mi>12340</span><span class=o>^</span><span class=mi>12346</span><span class=p>)</span><span class=o>.</span><span class=fm>__pow__</span><span class=p>(</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=fm>__eq__</span><span class=p>(</span><span class=mi>19244817692775379254742950967455327011704665906495063967001221701622487413797394300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><span class=p>)</span> <span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>The part <code>\x62\x79\x74\x65\x73</code> evaluates to <code>bytes</code> and <code>\x36\x39\x20\x36\x65\x20\x37\x30</code> evaluates to <code>69 6e 70</code>, which is <code>inp</code>.</p><p>So, we can easily sketch out the checker scheme, like this:</p><p><code>assert inp[a ^ b] ** e == ct</code></p><p>Knowing the algorithm, I wrote a quick and dirty script to solve it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;if [n for n in ().__class__.__base__.__subclasses__() if &#34;rni&#34; in n.__name__ and n.__name__ == n.__name__.lower()][0]()._module.__builtins__.__getitem__([n for n in ().__class__.__base__.__subclasses__() if &#34;rni&#34; in n.__name__ and n.__name__ == n.__name__.lower [...] in n.__name__ and n.__name__ == n.__name__.lower()][0]()._module.__builtins__.__getitem__(&#34;bytes&#34;),&#34;</span><span class=se>\x36\x39\x20\x36\x65\x20\x37\x30</span><span class=s1>&#34;).decode()).__getitem__(37143^37127).__pow__(39).__eq__(698305725136602387487529275219403181042627701878718020159538228622689033147)]):
</span></span></span><span class=line><span class=cl><span class=s1>  print(&#34;Correct!&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>else:
</span></span></span><span class=line><span class=cl><span class=s1>  print(&#34;Wrong!&#34;)&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>51</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>20</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;getitem&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>s</span> <span class=o>+</span> <span class=mi>7</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>500</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;getitem&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span> <span class=o>%</span> <span class=mi>9</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>k</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>s</span><span class=p>:</span><span class=n>s</span><span class=o>+</span><span class=mi>300</span><span class=p>][</span><span class=mi>10</span><span class=p>:]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>idx</span> <span class=o>=</span> <span class=nb>eval</span><span class=p>(</span><span class=n>k</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>k</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>9</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>k</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=mi>8</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>128</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span> <span class=o>==</span> <span class=n>res</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>flag</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>s</span> <span class=o>+</span> <span class=mi>7</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ictf{pYthOn_obFuScAtION_iS_N0_M4TCH_f0r_U_9e1b23f9</span>
</span></span></code></pre></td></tr></table></div></div><p>Somehow the <code>}</code> character didn&rsquo;t show up, but that didn&rsquo;t heavily affect the result anyway.</p><p>First blood for <code>thehackerscrew</code>!</p><p>Flag is: <strong>ictf{pYthOn_obFuScAtION_iS_N0_M4TCH_f0r_U_9e1b23f9}</strong></p><h2 id=snailchecker>snailchecker</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>check.py</code></li><li><strong>Description:</strong> Optimize me, if you dare. Or not. It might run if you try hard enough.</li></ul></div></div></div><p>We are given a shorter (and cleaner) Python source. I modified the <code>enc()</code> to see what it does.</p><p>The part <code>b[0] * 2 ** 24 + b[1] * 2 ** 16 + b[2] * 2 ** 8 + b[3] + 1</code> behaves the same with <code>int.from_bytes(b, 'big') + 1</code> so I changed it, then tried to call <code>enc(b'a')</code> while printing out the <code>a</code> array inside.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>enc</span><span class=p>(</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=n>n</span> <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=s1>&#39;big&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)][</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=p>,</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=nb>len</span><span class=p>([</span><span class=n>n</span> <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>a</span> <span class=k>if</span> <span class=n>n</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>%=</span> <span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>c</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>c</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enc</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>38</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mi>44</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>49</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>51</span><span class=p>,</span> <span class=mi>52</span><span class=p>,</span> <span class=mi>53</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>56</span><span class=p>,</span> <span class=mi>57</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>59</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>68</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>71</span><span class=p>,</span> <span class=mi>72</span><span class=p>,</span> <span class=mi>73</span><span class=p>,</span> <span class=mi>74</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>79</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>82</span><span class=p>,</span> <span class=mi>83</span><span class=p>,</span> <span class=mi>84</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>86</span><span class=p>,</span> <span class=mi>87</span><span class=p>,</span> <span class=mi>88</span><span class=p>,</span> <span class=mi>89</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>91</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>93</span><span class=p>,</span> <span class=mi>94</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>97</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>38</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mi>44</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>49</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>51</span><span class=p>,</span> <span class=mi>52</span><span class=p>,</span> <span class=mi>53</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>56</span><span class=p>,</span> <span class=mi>57</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>59</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>68</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>71</span><span class=p>,</span> <span class=mi>72</span><span class=p>,</span> <span class=mi>73</span><span class=p>,</span> <span class=mi>74</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>79</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>82</span><span class=p>,</span> <span class=mi>83</span><span class=p>,</span> <span class=mi>84</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>86</span><span class=p>,</span> <span class=mi>87</span><span class=p>,</span> <span class=mi>88</span><span class=p>,</span> <span class=mi>89</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>91</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>93</span><span class=p>,</span> <span class=mi>94</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>97</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>38</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mi>44</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>49</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>51</span><span class=p>,</span> <span class=mi>52</span><span class=p>,</span> <span class=mi>53</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>56</span><span class=p>,</span> <span class=mi>57</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>59</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>68</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>71</span><span class=p>,</span> <span class=mi>72</span><span class=p>,</span> <span class=mi>73</span><span class=p>,</span> <span class=mi>74</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>79</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>82</span><span class=p>,</span> <span class=mi>83</span><span class=p>,</span> <span class=mi>84</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>86</span><span class=p>,</span> <span class=mi>87</span><span class=p>,</span> <span class=mi>88</span><span class=p>,</span> <span class=mi>89</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>91</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>93</span><span class=p>,</span> <span class=mi>94</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>97</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>From the result, we can see the behaviour of the <code>enc()</code>, that first it generates an array contains elements from <code>1</code> to <code>int.from_bytes(b, b'big')</code>. Consider the array as a circle, where every <code>2nd</code> element is erased until there is only <code>1</code> element left. The remaining element will be the return value of the function.</p><p>With Competitive Programming experience, I immediately recognized that this was implementing <a href=https://www.geeksforgeeks.org/josephus-problem/ target=_blank rel="noopener noreffer">Josephus Problem</a>
. So our problem is given the winner of the game, we need to find how many people were involved in total.</p><p>I found <a href=https://sites.math.northwestern.edu/~mlerma/problem_solving/solutions/josephus.pdf target=_blank rel="noopener noreffer">this paper on Josephus Problem</a>
to solve it. Given that we have <code>n</code> people involved. The winner&rsquo;s position - which is defined by <code>j(n)</code> - is calculated as:</p><p><code>j(n) = left rotation of the binary digits of n</code></p><p>And, by doing right rotation on the encrypted value, we have solved our problem!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>k</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>k</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;L</span><span class=se>\xe8\xc6\xd2</span><span class=s1>f</span><span class=se>\xde\xd4\xf6</span><span class=s1>j</span><span class=se>\xd0\xe0\xca</span><span class=s1>d</span><span class=se>\xe0\xbe\xe6</span><span class=s1>J</span><span class=se>\xd8\xc4\xde</span><span class=s1>`</span><span class=se>\xe6\xbe\xda</span><span class=s1>&gt;</span><span class=se>\xc8\xca\xca</span><span class=s1>^</span><span class=se>\xde\xde\xc4</span><span class=s1>^</span><span class=se>\xde\xde\xde</span><span class=s1>z</span><span class=se>\xe8\xe6\xde</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk</span> <span class=o>=</span> <span class=n>enc</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span> <span class=o>+</span> <span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>tmp</span> <span class=o>=</span> <span class=nb>int</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=n>chunk</span><span class=p>,</span> <span class=s1>&#39;big&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=nb>int</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=n>solve</span><span class=p>(</span><span class=n>tmp</span><span class=p>),</span> <span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;big&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()[::</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ictf{josephus_problem_speed?boooooooost}</span>
</span></span></code></pre></td></tr></table></div></div><p>Somehow the flag should has <code>_</code> in place of that <code>?</code>, but again that didn&rsquo;t affect too much on the result.</p><p>Second blood for <code>thehackerscrew</code>!</p><p>Flag is: <strong>ictf{josephus_problem_speed_boooooooost}</strong></p><h2 id=scrambled>scrambled</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>main</code></li><li><strong>Description:</strong> The flag is all jumbled up&mldr; or is it?</li></ul></div></div></div><p>We are given an <code>ELF</code> file this time. Follow the xrefs<a href=https://fazect.github.io/amateursctf2023-rev/#rusteze-2 target=_blank rel="noopener noreffer">*</a>
of either <code>CORRECT!</code> or <code>INCORRECT!</code>, we can reach the main function for encryption.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl>  <span class=nf>qmemcpy</span><span class=p>(</span><span class=n>v30</span><span class=p>,</span> <span class=s>&#34;zyx^wu%v!ts1r;q@op#nm$lk(ijgh*fed&amp;ca0b-{})&#34;</span><span class=p>,</span> <span class=mi>42</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_407DF0</span><span class=p>(</span><span class=n>v27</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_4050E4</span><span class=p>(</span><span class=n>v25</span><span class=p>,</span> <span class=n>v30</span><span class=p>,</span> <span class=mi>42LL</span><span class=p>,</span> <span class=n>v27</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_407E10</span><span class=p>(</span><span class=n>v27</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_4051DE</span><span class=p>(</span><span class=n>v26</span><span class=p>,</span> <span class=n>v25</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v10</span> <span class=o>=</span> <span class=nf>sub_40534A</span><span class=p>(</span><span class=n>v26</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v11</span> <span class=o>=</span> <span class=nf>sub_4052FE</span><span class=p>(</span><span class=n>v26</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_40539A</span><span class=p>(</span><span class=n>v11</span><span class=p>,</span> <span class=n>v10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_4051DE</span><span class=p>(</span><span class=n>v27</span><span class=p>,</span> <span class=n>v25</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>m</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>m</span> <span class=o>&lt;</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int64</span><span class=p>)</span><span class=nf>sub_4770C0</span><span class=p>(</span><span class=n>v28</span><span class=p>);</span> <span class=o>++</span><span class=n>m</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>v12</span> <span class=o>=</span> <span class=nf>sub_4773E0</span><span class=p>(</span><span class=n>v28</span><span class=p>,</span> <span class=n>m</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>v13</span> <span class=o>=</span> <span class=nf>sub_40534A</span><span class=p>(</span><span class=n>v25</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>v14</span> <span class=o>=</span> <span class=nf>sub_4052FE</span><span class=p>(</span><span class=n>v25</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>v15</span> <span class=o>=</span> <span class=nf>sub_4053D0</span><span class=p>(</span><span class=n>v14</span><span class=p>,</span> <span class=n>v13</span><span class=p>,</span> <span class=n>v12</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>v16</span> <span class=o>=</span> <span class=nf>sub_4052FE</span><span class=p>(</span><span class=n>v25</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>v23</span> <span class=o>=</span> <span class=nf>sub_40540C</span><span class=p>(</span><span class=n>v16</span><span class=p>,</span> <span class=n>v15</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>LOBYTE</span><span class=p>(</span><span class=n>v15</span><span class=p>)</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>_BYTE</span> <span class=o>*</span><span class=p>)</span><span class=nf>sub_405442</span><span class=p>(</span><span class=n>v26</span><span class=p>,</span> <span class=n>v23</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=p>(</span><span class=n>_BYTE</span> <span class=o>*</span><span class=p>)</span><span class=nf>sub_4773E0</span><span class=p>(</span><span class=n>v28</span><span class=p>,</span> <span class=n>m</span><span class=p>)</span> <span class=o>=</span> <span class=n>v15</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=nf>sub_405462</span><span class=p>(</span><span class=n>v28</span><span class=p>,</span> <span class=s>&#34;oynuuvefmqjn1qlfnw$j*vmx1dv&#34;</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>sub_470AD0</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_5DF480</span><span class=p>,</span> <span class=s>&#34;CORRECT</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nf>sub_470AD0</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_5DF480</span><span class=p>,</span> <span class=s>&#34;INCORRECT</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>After some time debugging the code, I got the idea of it. Basically, the encryption is very simple. Consider <code>zyx^wu%v!ts1r;q@op#nm$lk(ijgh*fed&amp;ca0b-{})</code> as the custom alphabet. Each character in the input is changed to the <code>opposite</code> character in terms of their positions in the alphabet - for example <code>z</code> will be changed into <code>)</code>, <code>y</code> will be changed to <code>}</code>, and so on.</p><p>I wrote a script to decode the data, as below.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>alphabet</span> <span class=o>=</span> <span class=s1>&#39;zyx^wu%v!ts1r;q@op#nm$lk(ijgh*fed&amp;ca0b-</span><span class=si>{}</span><span class=s1>)&#39;</span>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=s1>&#39;ynuuvefmqjn1qlfnw$j*vmx1dvo&#39;</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>enc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>alphabet</span><span class=o>.</span><span class=n>rfind</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=n>alphabet</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>alphabet</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>s</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ictf{$cr@mbl1ngfl@g$1sc00l}</span>
</span></span></code></pre></td></tr></table></div></div><p>I had to change encoded data from <code>oynuuvefmqjn1qlfnw$j*vmx1dv</code> to <code>ynuuvefmqjn1qlfnw$j*vmx1dvo</code> to get the right order of the flag characters.</p><p>Flag is: <strong>ictf{Scr@mbl1ngfl@g$1sc00l}</strong></p><h2 id=sheepish>Sheepish</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>sheepish.py</code></li><li><strong>Description:</strong> Mary had a flagchecker, its fleece was white as snow.</li></ul></div></div></div><p>For this challenge, we are given a Python source. From the first glance, the source looks like it has control flow flattened by lambda functions.</p><p>So first, I did &mldr;</p><p>Actually, I found (probably) an unintended solution to just use side channel attack to bruteforce the flag. I tested for a while and saw that the flag is checked char by char, and when a char is wrong, the program immediately prints out <code>Try again</code>. So from that information, we can easily see that if we input in any correct prefix of the flag, the program should raise some errors.</p><p>I tried to do so and things went the same with what I had expected.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>ictf</span>
</span></span><span class=line><span class=cl><span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span><span class=p>:</span> <span class=s1>&#39;str&#39;</span> <span class=nb>object</span> <span class=ow>is</span> <span class=ow>not</span> <span class=n>callable</span>
</span></span></code></pre></td></tr></table></div></div><p>So I went on and wrote a script using side channel attack to get the flag.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;ictf{&#39;</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>flag</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;}&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>128</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=n>flag</span> <span class=o>+</span> <span class=nb>chr</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>((((</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:((</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:</span><span class=n>m</span><span class=p>(</span><span class=k>lambda</span> <span class=n>g</span><span class=p>:</span><span class=n>c</span><span class=p>(</span><span class=n>c</span><span class=p>)(</span><span class=n>g</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:</span><span class=n>m</span><span class=p>(</span><span class=k>lambda</span> <span class=n>g</span><span class=p>:</span><span class=n>c</span><span class=p>(</span><span class=n>c</span><span class=p>)(</span><span class=n>g</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span><span class=k>lambda</span> <span class=n>k</span><span class=p>:</span><span class=k>lambda</span> <span class=n>f</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>))(</span><span class=n>d</span><span class=p>))(</span><span class=n>k</span><span class=p>)(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:</span><span class=n>b</span><span class=p>(</span><span class=k>lambda</span> <span class=n>l</span><span class=p>:</span><span class=k>lambda</span> <span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=p>(</span><span class=n>l</span><span class=p>(</span><span class=n>m</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>c</span><span class=p>)(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=n>j</span><span class=p>))(</span><span class=n>j</span><span class=p>))(</span><span class=n>e</span><span class=p>)(</span><span class=n>j</span><span class=p>)))(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:</span><span class=n>b</span><span class=p>(</span><span class=k>lambda</span> <span class=n>l</span><span class=p>:</span><span class=k>lambda</span> <span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=p>(</span><span class=n>l</span><span class=p>(</span><span class=n>m</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>c</span><span class=p>)(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=n>j</span><span class=p>))(</span><span class=n>j</span><span class=p>))(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))(</span><span class=n>d</span><span class=p>)))(</span><span class=n>k</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))(</span><span class=n>d</span><span class=p>)))(</span><span class=n>f</span><span class=p>)))(</span><span class=n>m</span><span class=p>((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))(</span><span class=n>d</span><span class=p>)))(</span><span class=n>k</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span><span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>))(</span><span class=n>d</span><span class=p>)))(</span><span class=n>f</span><span class=p>))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>)(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>e</span><span class=p>))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>(</span><span class=n>n</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>(</span><span class=n>j</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>j</span><span class=p>(</span><span class=n>e</span><span class=p>))))))(((</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:((</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:</span><span class=n>m</span><span class=p>(</span><span class=k>lambda</span> <span class=n>g</span><span class=p>:</span><span class=n>c</span><span class=p>(</span><span class=n>c</span><span class=p>)(</span><span class=n>g</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:</span><span class=n>m</span><span class=p>(</span><span class=k>lambda</span> <span class=n>g</span><span class=p>:</span><span class=n>c</span><span class=p>(</span><span class=n>c</span><span class=p>)(</span><span class=n>g</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>h</span><span class=p>:(((</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=n>c</span><span class=p>)(</span><span class=n>d</span><span class=p>)))(</span><span class=n>m</span><span class=p>(</span><span class=n>h</span><span class=p>[</span><span class=mi>1</span><span class=p>:]))(((</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:((</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:</span><span class=n>m</span><span class=p>(</span><span class=k>lambda</span> <span class=n>g</span><span class=p>:</span><span class=n>c</span><span class=p>(</span><span class=n>c</span><span class=p>)(</span><span class=n>g</span><span class=p>)))(</span><span class=k>lambda</span> <span class=n>c</span><span class=p>:</span><span class=n>m</span><span class=p>(</span><span class=k>lambda</span> <span class=n>g</span><span class=p>:</span><span class=n>c</span><span class=p>(</span><span class=n>c</span><span class=p>)(</span><span class=n>g</span><span class=p>)))))(</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:(</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:(((</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>(</span><span class=n>b</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>)))(</span><span class=n>m</span><span class=p>(</span><span class=n>b</span><span class=o>-</span><span class=mi>1</span><span class=p>)))</span> <span class=k>if</span> <span class=n>b</span> <span class=k>else</span> <span class=p>(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>e</span><span class=p>)))))(</span><span class=n>h</span><span class=p>[</span><span class=mi>0</span><span class=p>])))</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>h</span><span class=p>)</span> <span class=k>else</span> <span class=p>((</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=k>lambda</span> <span class=n>n</span><span class=p>:</span><span class=n>n</span><span class=p>(</span><span class=n>j</span><span class=p>)(</span><span class=n>e</span><span class=p>))(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>)(</span><span class=k>lambda</span> <span class=n>j</span><span class=p>:</span><span class=k>lambda</span> <span class=n>e</span><span class=p>:</span><span class=n>j</span><span class=p>))))))(</span><span class=n>tmp</span><span class=o>.</span><span class=n>encode</span><span class=p>())))(</span><span class=n>tmp</span><span class=p>)(</span><span class=s2>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>TypeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span> <span class=o>=</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ictf{d0_sh33p_b@@@?}</span>
</span></span></code></pre></td></tr></table></div></div><p>Flag is: <code>ictf{d0_sh33p_b@@@?}</code></p><h2 id=vmcastle>vmcastle</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>vm</code> and <code>program</code></li><li><strong>Description:</strong> There are no rules of architecture for a castle in the clouds.</li></ul></div></div></div><p>A <code>vm</code> challenge is given to us for this challenge. My way of tackling a <code>vm</code> challenge is to first write an interpreter.</p><p>But before doing that, we should take a look at how the <code>vm</code> and the variables are set up.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>((</span><span class=kt>void</span> <span class=p>(</span><span class=kr>__fastcall</span> <span class=o>*</span><span class=p>)(</span><span class=n>_QWORD</span><span class=p>))</span><span class=n>funcs_2838</span><span class=p>[(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>_WORD</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>ptr</span><span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=n>dword_6840</span><span class=p>]])((</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)(</span><span class=kt>char</span><span class=p>)</span><span class=nf>HIBYTE</span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=n>_WORD</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>ptr</span><span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=n>dword_6840</span><span class=p>]));</span>
</span></span><span class=line><span class=cl>    <span class=o>++</span><span class=n>dword_6840</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Here is the main loop of the <code>vm</code>. We can easily see that with <code>ptr</code> contains the program, the vm works by continuously calling the following function: <code>funcs[ptr[2 * i]](ptr[2 * i + 1])</code>. So for each pair of bytes from the program, the first byte is used to indicate which function is called, and the second byte will be the parameter for that function.</p><p>The memory of the <code>vm</code> is declared as a block of length <code>1024</code> containing <code>DWORDs</code> from offset <code>0x5840</code>. Right next to the memory block within the bss segment are some global variables, as shown below.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>bss:0000000000006840 dword_6840      dd ?                    ; DATA XREF: sub_24EA+D↑r
</span></span><span class=line><span class=cl>.bss:0000000000006840                                         ; sub_24EA+36↑w ...
</span></span><span class=line><span class=cl>.bss:0000000000006844 dword_6844      dd ?                    ; DATA XREF: sub_2269+D↑r
</span></span><span class=line><span class=cl>.bss:0000000000006844                                         ; sub_2269+16↑w ...
</span></span><span class=line><span class=cl>.bss:0000000000006848 ; char *ptr
</span></span><span class=line><span class=cl>.bss:0000000000006848 ptr             dq ?                    ; DATA XREF: main+35↑w
</span></span><span class=line><span class=cl>.bss:0000000000006848                                         ; main+CD↑r ...
</span></span><span class=line><span class=cl>.bss:0000000000006850 dword_6850      dd ?                    ; DATA XREF: sub_238F+D↑r
</span></span><span class=line><span class=cl>.bss:0000000000006850                                         ; sub_2455+D↑r ...
</span></span><span class=line><span class=cl>.bss:0000000000006854 dword_6854      dd ?                    ; DATA XREF: sub_238F+13↑r
</span></span><span class=line><span class=cl>.bss:0000000000006854                                         ; sub_2455+13↑r ...
</span></span><span class=line><span class=cl>.bss:0000000000006858 dword_6858      dd ?                    ; DATA XREF: sub_2529+5D↑r
</span></span><span class=line><span class=cl>.bss:000000000000685C dword_685C      dd ?                    ; DATA XREF: sub_238F+1B↑w
</span></span><span class=line><span class=cl>.bss:000000000000685C                                         ; sub_2455+1B↑w ...
</span></span><span class=line><span class=cl>.bss:000000000000685C _bss            ends
</span></span><span class=line><span class=cl>.bss:000000000000685C
</span></span></code></pre></td></tr></table></div></div><p>So to make the <code>vm</code> interpreter behaves correctly, we have to consider <code>dword_6840</code> as <code>memory[1025]</code>, <code>dword_6844</code> as <code>memory[1026]</code>, and so on. Also take into account that <code>ptr</code> takes up a 2-byte space, not 1-byte space.</p><p>Further more, the analysis into the functions also reveals that one function might be interpreted wrong if not handled correctly, which is the below function - corresponds with opcode <code>104</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kr>__int64</span> <span class=kr>__fastcall</span> <span class=nf>sub_2351</span><span class=p>(</span><span class=kt>char</span> <span class=n>a1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>__int64</span> <span class=n>result</span><span class=p>;</span> <span class=c1>// rax
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=o>++</span><span class=n>dword_6844</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=n>a1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>dword_5840</span><span class=p>[</span><span class=n>dword_6844</span><span class=p>]</span> <span class=o>=</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>The assembly code for this function uses <code>movsxd rdx, edx</code> instead of move without sign extend to assign <code>a1</code> onto the memory, so we have to replicate that when writing an interpreter for the program.</p><p>Considered all of that, I wrote an interpreter for this <code>vm</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;D:/ctf/revChalls/imaginaryCTF/program&#34;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mem</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2000</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;ictf</span><span class=si>{fake_flag}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>op</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>par</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>102</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>v1</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=n>v1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: set mem[</span><span class=si>{}</span><span class=s1>] = mem[</span><span class=si>{}</span><span class=s1>] == </span><span class=si>{}</span><span class=s1> and mem[1025] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=p>(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>,</span> <span class=n>v1</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=n>v1</span><span class=p>],</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>%</span> <span class=mi>1024</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>%=</span> <span class=mi>1024</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>103</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: set mem[</span><span class=si>{}</span><span class=s1>] = mem[</span><span class=si>{}</span><span class=s1>] == </span><span class=si>{}</span><span class=s1> and mem[1025] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>],</span> <span class=p>(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]],</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>%</span> <span class=mi>1024</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>%=</span> <span class=mi>1024</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>104</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>par</span> <span class=o>&gt;=</span> <span class=mi>128</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>par</span> <span class=o>=</span> <span class=n>par</span> <span class=o>-</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: set mem[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>],</span> <span class=n>par</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]</span> <span class=o>=</span> <span class=n>par</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>105</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>+</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1031] = mem[1028] + mem[1029] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>106</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>-</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1031] = mem[1028] - mem[1029] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>107</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>*</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1031] = mem[1028] * mem[1029] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>108</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>//</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1031] = mem[1028] // mem[1029] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>109</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>%</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1031] = mem[1028] % mem[1029] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>110</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1024] += mem[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=p>(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>111</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1030</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1024] += mem[1030] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1024] += mem[1028] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1024] += mem[1029] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>112</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>==</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: mem[1028] = </span><span class=si>{}</span><span class=s1>, mem[1029] = </span><span class=si>{}</span><span class=s1> -&gt; mem[1031] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>],</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>],</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>113</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: print mem[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=p>(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>,</span> <span class=nb>chr</span><span class=p>((</span><span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>114</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>inp</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>inp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: set mem[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1> (input)&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=p>(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>,</span> <span class=nb>ord</span><span class=p>(</span><span class=n>inp</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>115</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]</span> <span class=o>&lt;&lt;=</span> <span class=n>par</span> <span class=o>&amp;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: set mem[</span><span class=si>{}</span><span class=s1>] &lt;&lt;= </span><span class=si>{}</span><span class=s1> == </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>],</span> <span class=p>(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>),</span> <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>116</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]</span> <span class=o>+=</span> <span class=n>par</span> <span class=o>&amp;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: set mem[</span><span class=si>{}</span><span class=s1>] += </span><span class=si>{}</span><span class=s1> == </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>op</span><span class=p>,</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>],</span> <span class=p>(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>),</span> <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>117</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>114</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=mi>105</span> <span class=p>(</span><span class=nb>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>114</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=mi>99</span> <span class=p>(</span><span class=nb>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>114</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span> <span class=p>(</span><span class=nb>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>89</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>89</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>Y</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>111</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>111</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span> <span class=o>=</span> <span class=n>o</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>117</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1030</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>117</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1030</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>32</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span>  
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>108</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1030</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>108</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1030</span><span class=p>]</span> <span class=o>=</span> <span class=n>l</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>111</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>111</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span> <span class=o>=</span> <span class=n>o</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>115</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>115</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>s</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>101</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>101</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>e</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>33</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>33</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span> <span class=o>=</span> <span class=err>!</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>104</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>102</span><span class=p>:</span> <span class=nb>set</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>==</span> <span class=mi>10</span> <span class=ow>and</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>113</span><span class=p>:</span> <span class=nb>print</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span> <span class=o>=</span> 
</span></span></code></pre></td></tr></table></div></div><p>From the output, I saw that the input is read until the program encounters <code>\n</code>, which in <code>ASCII</code> is <code>10</code>. Then the flag is checked backward through some maths and then checked with a hardcoded value.</p><p>Again, I used side channel attack to bruteforce the flag backward, using the below script.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;D:/ctf/revChalls/imaginaryCTF/program&#34;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ans</span> <span class=o>=</span> <span class=s2>&#34;}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cnt</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>ans</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;{&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>128</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;*&#39;</span> <span class=o>+</span> <span class=nb>chr</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>+</span> <span class=n>ans</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>mem</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>4096</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>op</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>par</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>102</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>v1</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[</span><span class=n>v1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>%=</span> <span class=mi>1024</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>103</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]</span> <span class=o>=</span> <span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>%=</span> <span class=mi>1024</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>104</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>par</span> <span class=o>&gt;=</span> <span class=mi>128</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>par</span> <span class=o>=</span> <span class=n>par</span> <span class=o>-</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]</span> <span class=o>=</span> <span class=n>par</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>105</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>+</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>106</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>-</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>107</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>*</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>108</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>//</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>109</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>%</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>110</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>111</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1030</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>112</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>==</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                            <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>mem</span><span class=p>[</span><span class=mi>1031</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1028</span><span class=p>]</span> <span class=o>==</span> <span class=n>mem</span><span class=p>[</span><span class=mi>1029</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>113</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>abcd</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># does nothing lol</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>114</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>inp</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[(</span><span class=n>par</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1028</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>inp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>115</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]</span> <span class=o>&lt;&lt;=</span> <span class=n>par</span> <span class=o>&amp;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>116</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>mem</span><span class=p>[</span><span class=n>mem</span><span class=p>[</span><span class=mi>1025</span><span class=p>]]</span> <span class=o>+=</span> <span class=n>par</span> <span class=o>&amp;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>117</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>mem</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tmp</span> <span class=o>==</span> <span class=n>cnt</span> <span class=o>+</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ans</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>+</span> <span class=n>ans</span>
</span></span><span class=line><span class=cl>            <span class=n>cnt</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;ictf&#39;</span> <span class=o>+</span> <span class=n>ans</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ictf{babyvm_sUccessfULly_craCKEd_ee938a5954da916add9bae5f1ebc458561e231134ae5ea06}</span>
</span></span></code></pre></td></tr></table></div></div><p>Flag is: <strong>ictf{babyvm_sUccessfULly_craCKEd_ee938a5954da916add9bae5f1ebc458561e231134ae5ea06}</strong></p><h2 id=typechecker>Typechecker</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>ts.ts</code></li><li><strong>Description:</strong> All you need is to make it compile without error!</li></ul></div></div></div><p>We are given a source written in Typescript. From what was given in the source, I can see that it probably does something related to matrix. But first we should deobfuscate the variable names xD</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Change the flag below until it compiles correctly on TypeScript 5.1.6 :)
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>flag</span> <span class=o>=</span> <span class=s1>&#39;ictf{__________________________________________________________}&#39;</span>
</span></span><span class=line><span class=cl><span class=cm>/* Do not change anything below */</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>SourceString</span> <span class=o>=</span> <span class=s1>&#39;eZ!gjyTdSLcJ3{!Y_pTcMqW7qu{cMoyb04JXFHUaXx{8gTCIwIGE-AAWb1_wu32{&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>TargetString</span> <span class=o>=</span> <span class=s1>&#39;HuuMKaxLVHVqC6NSB1Rwl2WC1F7zkxxrxAuZFpPogbBd4LGGgBfK9!eUaaSIuqJK&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>CharSet</span> <span class=o>=</span> <span class=s1>&#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ{_-!}&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>InitialLength</span> <span class=o>=</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>TargetLength</span> <span class=o>=</span> <span class=mi>67</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>SplitStringToChars</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>InputString</span> <span class=kr>extends</span> <span class=kt>string</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>SplitStringArray</span> <span class=kr>extends</span> <span class=kt>string</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>InputString</span> <span class=kr>extends</span> <span class=sb>`</span><span class=si>${</span><span class=k>infer</span> <span class=nx>head</span><span class=si>}${</span><span class=k>infer</span> <span class=nx>rest</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>SplitStringToChars</span><span class=p>&lt;</span><span class=nt>rest</span><span class=err>,</span> <span class=err>[</span><span class=na>...SplitStringArray</span><span class=err>,</span> <span class=na>head</span><span class=err>]</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=o>:</span> <span class=nx>SplitStringArray</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ConstructObject</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>CharSequence</span> <span class=kr>extends</span> <span class=kt>string</span><span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>NumberSequence</span> <span class=kr>extends</span> <span class=kt>number</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>ResultObject</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>NumberSequence</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span> <span class=kr>extends</span> <span class=nx>CharSequence</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>ResultObject</span>
</span></span><span class=line><span class=cl>	: <span class=kt>ConstructObject</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>CharSequence</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>[...</span><span class=nx>NumberSequence</span><span class=p>,</span> <span class=kt>any</span><span class=p>],</span>
</span></span><span class=line><span class=cl>			<span class=nx>ResultObject</span> <span class=o>&amp;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=p>[</span><span class=nx>_</span> <span class=k>in</span> <span class=nx>CharSequence</span><span class=p>[</span><span class=nx>NumberSequence</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]]]</span><span class=o>:</span> <span class=nx>NumberSequence</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ObjectFromCharSet</span> <span class=o>=</span> <span class=nx>ConstructObject</span><span class=p>&lt;</span><span class=nt>SplitStringToChars</span><span class=err>&lt;</span><span class=na>CharSet</span><span class=p>&gt;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>BuildNumberArray</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>KeyNumberObject</span> <span class=kr>extends</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=p>[</span><span class=nx>k</span> <span class=k>in</span> <span class=kt>string</span><span class=p>]</span><span class=o>:</span> <span class=kt>number</span>
</span></span><span class=line><span class=cl>	<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=nx>KeyArray</span> <span class=kr>extends</span> <span class=p>(</span><span class=k>keyof</span> <span class=nx>KeyNumberObject</span><span class=p>)[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>NumberArray</span> <span class=kr>extends</span> <span class=kt>number</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>NumberArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span> <span class=kr>extends</span> <span class=nx>KeyArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>NumberArray</span>
</span></span><span class=line><span class=cl>	: <span class=kt>BuildNumberArray</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>KeyNumberObject</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>KeyArray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>[...</span><span class=nx>NumberArray</span><span class=p>,</span> <span class=nx>KeyNumberObject</span><span class=p>[</span><span class=nx>KeyArray</span><span class=p>[</span><span class=nx>NumberArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]]]]</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>TypeComparison</span><span class=p>&lt;</span><span class=nt>Type1</span><span class=err>,</span> <span class=na>Type2</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>(&lt;</span><span class=nt>T</span><span class=p>&gt;()</span> <span class=o>=&gt;</span> <span class=nx>T</span> <span class=kr>extends</span> <span class=nx>Type1</span> <span class=o>?</span> <span class=nx>1</span> : <span class=kt>2</span><span class=p>)</span> <span class=kr>extends</span> <span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>T</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span><span class=p>()</span> <span class=o>=&gt;</span> <span class=nx>T</span> <span class=kr>extends</span> <span class=nx>Type2</span> <span class=o>?</span> <span class=nx>1</span> : <span class=kt>2</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>	<span class=o>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>FirstElement</span><span class=p>&lt;</span><span class=nt>ArrayType</span> <span class=na>extends</span> <span class=na>unknown</span><span class=err>[]</span><span class=p>&gt;</span> <span class=o>=</span> <span class=nx>ArrayType</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>LastElement</span><span class=p>&lt;</span><span class=nt>ArrayType</span> <span class=na>extends</span> <span class=na>unknown</span><span class=err>[]</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>[</span><span class=kt>any</span><span class=p>,</span> <span class=p>...</span><span class=nx>ArrayType</span><span class=p>][</span><span class=nx>ArrayType</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ArrayBuild</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>InputArray</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>TargetLength</span> <span class=kr>extends</span> <span class=kt>number</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>OutputArray</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>OutputArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span> <span class=kr>extends</span> <span class=nx>TargetLength</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>OutputArray</span>
</span></span><span class=line><span class=cl>	: <span class=kt>ArrayBuild</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>InputArray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>TargetLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>[...</span><span class=nx>OutputArray</span><span class=p>,</span> <span class=nx>InputArray</span><span class=p>[</span><span class=nx>OutputArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]]]</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ArrayExtend</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>InputArray</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>TargetLength</span> <span class=kr>extends</span> <span class=kt>number</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>OutputArray</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>OutputArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span> <span class=kr>extends</span> <span class=nx>TargetLength</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>OutputArray</span>
</span></span><span class=line><span class=cl>	: <span class=kt>ArrayExtend</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>InputArray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>TargetLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>[[...</span><span class=nx>OutputArray</span><span class=p>,</span> <span class=kt>any</span><span class=p>,</span> <span class=p>...</span><span class=nx>InputArray</span><span class=p>][</span><span class=nx>InputArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]],</span> <span class=p>...</span><span class=nx>OutputArray</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ArrayWithLast</span><span class=p>&lt;</span><span class=nt>InputArray</span> <span class=na>extends</span> <span class=na>unknown</span><span class=err>[],</span> <span class=na>TargetLength</span> <span class=na>extends</span> <span class=na>number</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>	<span class=nx>LastElement</span><span class=p>&lt;</span><span class=nt>InputArray</span><span class=p>&gt;,</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span><span class=nx>ArrayBuild</span><span class=p>&lt;</span><span class=nt>InputArray</span><span class=err>,</span> <span class=na>TargetLength</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ArrayWithFirst</span><span class=p>&lt;</span><span class=nt>InputArray</span> <span class=na>extends</span> <span class=na>unknown</span><span class=err>[],</span> <span class=na>TargetLength</span> <span class=na>extends</span> <span class=na>number</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span><span class=nx>ArrayExtend</span><span class=p>&lt;</span><span class=nt>InputArray</span><span class=err>,</span> <span class=na>TargetLength</span><span class=p>&gt;,</span>
</span></span><span class=line><span class=cl>	<span class=nx>FirstElement</span><span class=p>&lt;</span><span class=nt>InputArray</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ArrayToLength</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>TargetLength</span> <span class=kr>extends</span> <span class=kt>number</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>OutputArray</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>TargetLength</span> <span class=kr>extends</span> <span class=nx>OutputArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>OutputArray</span>
</span></span><span class=line><span class=cl>	: <span class=kt>ArrayToLength</span><span class=p>&lt;</span><span class=nt>TargetLength</span><span class=err>,</span> <span class=err>[</span><span class=na>...OutputArray</span><span class=err>,</span> <span class=na>OutputArray</span><span class=err>[&#39;</span><span class=na>length</span><span class=err>&#39;]]</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>BuildObjectWithLength</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>TargetLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>IntermediateArray</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>ResultObject</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>IntermediateArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span> <span class=kr>extends</span> <span class=nx>TargetLength</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>ResultObject</span>
</span></span><span class=line><span class=cl>	: <span class=kt>BuildObjectWithLength</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>TargetLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>[...</span><span class=nx>IntermediateArray</span><span class=p>,</span> <span class=kt>any</span><span class=p>],</span>
</span></span><span class=line><span class=cl>			<span class=nx>ResultObject</span> <span class=o>&amp;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=p>[</span><span class=nx>_</span> <span class=k>in</span> <span class=nx>IntermediateArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]]</span><span class=o>:</span> <span class=kt>unknown</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>// @ts-ignore
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>type</span> <span class=nx>GetElementAt</span><span class=p>&lt;</span><span class=nt>Length</span> <span class=na>extends</span> <span class=na>number</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>[</span><span class=kt>any</span><span class=p>,</span> <span class=p>...</span><span class=nx>ArrayToLength</span><span class=p>&lt;</span><span class=nt>Length</span><span class=p>&gt;][</span><span class=nx>Length</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>TargetArray</span> <span class=o>=</span> <span class=nx>ArrayToLength</span><span class=p>&lt;</span><span class=nt>TargetLength</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ArrayWithFirstAndLast</span> <span class=o>=</span> <span class=nx>ArrayWithFirst</span><span class=p>&lt;</span><span class=nt>TargetArray</span><span class=err>,</span> <span class=na>GetElementAt</span><span class=err>&lt;</span><span class=na>TargetLength</span><span class=p>&gt;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ArrayWithLastAndBuild</span> <span class=o>=</span> <span class=nx>ArrayWithLast</span><span class=p>&lt;</span><span class=nt>TargetArray</span><span class=err>,</span> <span class=na>GetElementAt</span><span class=err>&lt;</span><span class=na>TargetLength</span><span class=p>&gt;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>RecursivePick</span><span class=p>&lt;</span><span class=nt>StartIndex</span> <span class=na>extends</span> <span class=na>number</span><span class=err>,</span> <span class=na>Depth</span> <span class=na>extends</span> <span class=na>number</span><span class=p>&gt;</span> <span class=o>=</span> <span class=nx>Depth</span> <span class=kr>extends</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>StartIndex</span>
</span></span><span class=line><span class=cl>	: <span class=kt>RecursivePick</span><span class=p>&lt;</span><span class=nt>ArrayWithFirstAndLast</span><span class=err>[</span><span class=na>StartIndex</span><span class=err>],</span> <span class=na>ArrayWithLastAndBuild</span><span class=err>[</span><span class=na>Depth</span><span class=err>]</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>RecursiveDepth</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>StartIndex</span> <span class=kr>extends</span> <span class=kt>number</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>Depth</span> <span class=kr>extends</span> <span class=kt>number</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>CurrentValue</span> <span class=kr>extends</span> <span class=kt>number</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>Depth</span> <span class=kr>extends</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>CurrentValue</span>
</span></span><span class=line><span class=cl>	: <span class=kt>RecursiveDepth</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>StartIndex</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>ArrayWithLastAndBuild</span><span class=p>[</span><span class=nx>Depth</span><span class=p>],</span>
</span></span><span class=line><span class=cl>			<span class=nx>RecursivePick</span><span class=p>&lt;</span><span class=nt>CurrentValue</span><span class=err>,</span> <span class=na>StartIndex</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>RecursiveArrayBuilder</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>ArraySequence</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>ArrayLength</span> <span class=kr>extends</span> <span class=kt>number</span> <span class=o>=</span> <span class=nx>InitialLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>TargetLength</span> <span class=kr>extends</span> <span class=kt>number</span> <span class=o>=</span> <span class=nx>InitialLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>IntermediateArray</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[][]</span> <span class=o>=</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>ArrayTracker</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>ArrayIndexTracker</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>IntermediateArray</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span> <span class=kr>extends</span> <span class=nx>ArrayLength</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>IntermediateArray</span>
</span></span><span class=line><span class=cl>	: <span class=kt>ArrayTracker</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span> <span class=kr>extends</span> <span class=nx>TargetLength</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>RecursiveArrayBuilder</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>ArraySequence</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>ArrayLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>TargetLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>[...</span><span class=nx>IntermediateArray</span><span class=p>,</span> <span class=nx>ArrayTracker</span><span class=p>],</span>
</span></span><span class=line><span class=cl>			<span class=p>[],</span>
</span></span><span class=line><span class=cl>			<span class=nx>ArrayIndexTracker</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=o>:</span> <span class=nx>RecursiveArrayBuilder</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>ArraySequence</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>ArrayLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>TargetLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>IntermediateArray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>[...</span><span class=nx>ArrayTracker</span><span class=p>,</span> <span class=nx>ArraySequence</span><span class=p>[</span><span class=nx>ArrayIndexTracker</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]]],</span>
</span></span><span class=line><span class=cl>			<span class=p>[...</span><span class=nx>ArrayIndexTracker</span><span class=p>,</span> <span class=kt>any</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ConstructObjectGrid</span><span class=p>&lt;</span><span class=nt>GridLengthX</span><span class=err>,</span> <span class=na>GridLengthY</span> <span class=na>extends</span> <span class=na>number</span><span class=err>,</span> <span class=na>TargetLength</span> <span class=na>extends</span> <span class=na>number</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=p>[</span><span class=nx>i</span> <span class=k>in</span> <span class=k>keyof</span> <span class=nx>BuildObjectWithLength</span><span class=p>&lt;</span><span class=nt>GridLengthY</span><span class=p>&gt;]</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=p>[</span><span class=nx>j</span> <span class=k>in</span> <span class=k>keyof</span> <span class=nx>BuildObjectWithLength</span><span class=p>&lt;</span><span class=nt>TargetLength</span><span class=p>&gt;]</span><span class=o>:</span> <span class=nx>GridLengthX</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ComputeRecursion</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>ArraySequence</span> <span class=kr>extends</span> <span class=nx>ArrayLike</span><span class=p>&lt;</span><span class=nt>number</span><span class=p>&gt;,</span>
</span></span><span class=line><span class=cl>	<span class=nx>RecursionResult</span> <span class=kr>extends</span> <span class=kt>number</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>RecursionTracker</span> <span class=kr>extends</span> <span class=kt>unknown</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=nx>RecursionTracker</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span> <span class=kr>extends</span> <span class=nx>ArraySequence</span><span class=p>[</span><span class=s1>&#39;length&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=o>?</span> <span class=nx>RecursionResult</span>
</span></span><span class=line><span class=cl>	: <span class=kt>ComputeRecursion</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=nx>ArraySequence</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>RecursivePick</span><span class=p>&lt;</span><span class=nt>RecursionResult</span><span class=err>,</span> <span class=na>ArraySequence</span><span class=err>[</span><span class=na>RecursionTracker</span><span class=err>[&#39;</span><span class=na>length</span><span class=err>&#39;]]</span><span class=p>&gt;,</span>
</span></span><span class=line><span class=cl>			<span class=p>[...</span><span class=nx>RecursionTracker</span><span class=p>,</span> <span class=kt>any</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>ComputeGrid</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>Grid1</span> <span class=kr>extends</span> <span class=nx>ConstructObjectGrid</span><span class=p>&lt;</span><span class=nt>number</span><span class=err>,</span> <span class=na>GridLengthX</span><span class=err>,</span> <span class=na>GridLengthY</span><span class=p>&gt;,</span>
</span></span><span class=line><span class=cl>	<span class=nx>Grid2</span> <span class=kr>extends</span> <span class=nx>ConstructObjectGrid</span><span class=p>&lt;</span><span class=nt>number</span><span class=err>,</span> <span class=na>GridLengthY</span><span class=err>,</span> <span class=na>GridLengthZ</span><span class=p>&gt;,</span>
</span></span><span class=line><span class=cl>	<span class=nx>GridLengthX</span> <span class=kr>extends</span> <span class=kt>number</span> <span class=o>=</span> <span class=nx>InitialLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>GridLengthY</span> <span class=kr>extends</span> <span class=kt>number</span> <span class=o>=</span> <span class=nx>InitialLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>GridLengthZ</span> <span class=kr>extends</span> <span class=kt>number</span> <span class=o>=</span> <span class=nx>InitialLength</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=p>[</span><span class=nx>i</span> <span class=k>in</span> <span class=k>keyof</span> <span class=nx>BuildObjectWithLength</span><span class=p>&lt;</span><span class=nt>GridLengthX</span><span class=p>&gt;]</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=p>[</span><span class=nx>k</span> <span class=k>in</span> <span class=k>keyof</span> <span class=nx>BuildObjectWithLength</span><span class=p>&lt;</span><span class=nt>GridLengthZ</span><span class=p>&gt;]</span><span class=o>:</span> <span class=nx>ComputeRecursion</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>			<span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=p>[</span><span class=nx>j</span> <span class=k>in</span> <span class=k>keyof</span> <span class=nx>BuildObjectWithLength</span><span class=p>&lt;</span><span class=nt>GridLengthY</span><span class=p>&gt;]</span><span class=o>:</span> <span class=nx>RecursiveDepth</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>					<span class=nx>Grid1</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=nx>Grid2</span><span class=p>[</span><span class=nx>j</span><span class=p>][</span><span class=nx>k</span><span class=p>]</span>
</span></span><span class=line><span class=cl>				<span class=o>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=o>&amp;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>length</span>: <span class=kt>GridLengthY</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=o>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>BuildNumericArray</span><span class=p>&lt;</span><span class=nt>Source</span> <span class=na>extends</span> <span class=na>string</span><span class=p>&gt;</span> <span class=o>=</span> <span class=nx>RecursiveArrayBuilder</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>	<span class=nx>BuildNumberArray</span><span class=p>&lt;</span><span class=nt>ObjectFromCharSet</span><span class=err>,</span> <span class=na>SplitStringToChars</span><span class=err>&lt;</span><span class=na>Source</span><span class=p>&gt;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>Type1</span> <span class=o>=</span> <span class=nx>BuildNumericArray</span><span class=p>&lt;</span><span class=nt>typeof</span> <span class=na>flag</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>SourceType</span> <span class=o>=</span> <span class=nx>BuildNumericArray</span><span class=p>&lt;</span><span class=nt>SourceString</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>TargetType</span> <span class=o>=</span> <span class=nx>BuildNumericArray</span><span class=p>&lt;</span><span class=nt>TargetString</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>SourceFlag</span> <span class=o>=</span> <span class=nx>ComputeGrid</span><span class=p>&lt;</span><span class=nt>SourceType</span><span class=err>,</span> <span class=na>Type1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>type</span> <span class=nx>TargetFlag</span> <span class=o>=</span> <span class=nx>ComputeGrid</span><span class=p>&lt;</span><span class=nt>Type1</span><span class=err>,</span> <span class=na>TargetType</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>isTheFlagCorrect</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>good</span>: <span class=kt>TypeComparison</span><span class=o>&lt;</span>
</span></span><span class=line><span class=cl>		<span class=nx>SourceFlag</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>TargetFlag</span>
</span></span><span class=line><span class=cl>	<span class=o>&gt;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span>: <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=sr>/^ictf{.{56}}$/</span><span class=p>.</span><span class=nx>test</span><span class=p>(</span><span class=nx>flag</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>good</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Correct, the flag is&#39;</span><span class=p>,</span> <span class=nx>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Wrong!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>isTheFlagCorrect</span><span class=p>(</span><span class=kc>true</span><span class=p>,</span> <span class=nx>flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>From the source, we probably can see that it is doing something with matrices. And it is also really easy to see that the <code>SourceString</code> and <code>TargetString</code> are converted into matrix using the <code>Charset</code>, or we can use <code>VSCode extension</code> to debug and retrieve values of <code>SourceType</code> and <code>TargetType</code>.</p><p>Our team was stucked for quite a while on what to do next then someone made a guess that <code>ComputeGrid</code> was just doing matrix multiplication in <code>GF(67)</code>. So I went on and wrote a sage script, while another person tried to debug, then compared the results.</p><img src=1.png alt width=600>
<img src=2.png alt width=600><p>And, it was indeed doing matrix multiplication in <code>GF(67)</code>. From the source, with that precious information, we went on to conclude that matrix <code>x</code> of size <code>8 * 8</code>, with <code>2</code> last elements are padded with <code>2</code> <code>0s</code> such that <code>ax = xb</code> in <code>GF(67)</code> will be the flag for our challenge.</p><p>The final works were handled by a Crypto player from the team, and he didn&rsquo;t let us down on this.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>matmul</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>B</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>0</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>)]</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>A</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>B</span><span class=p>[</span><span class=mi>0</span><span class=p>])):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>B</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>                <span class=n>result</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+</span> <span class=n>A</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=n>B</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>printable</span> <span class=o>=</span> <span class=s1>&#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ{_-!}&#39;</span>
</span></span><span class=line><span class=cl><span class=n>map_print</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>printable</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>map_print</span><span class=p>[</span><span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>F</span> <span class=o>=</span> <span class=n>GF</span><span class=p>(</span><span class=mi>67</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>14</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>13</span><span class=p>],</span> <span class=p>[</span><span class=mi>54</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>60</span><span class=p>],</span> <span class=p>[</span><span class=mi>63</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span>
</span></span><span class=line><span class=cl>     <span class=p>[</span><span class=mi>26</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>11</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>59</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mi>56</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=p>[</span><span class=mi>59</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>62</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>38</span><span class=p>,</span> <span class=mi>44</span><span class=p>],</span>
</span></span><span class=line><span class=cl>     <span class=p>[</span><span class=mi>32</span><span class=p>,</span> <span class=mi>44</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>58</span><span class=p>],</span> <span class=p>[</span><span class=mi>11</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>62</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>43</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>47</span><span class=p>],</span> <span class=p>[</span><span class=mi>57</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mi>57</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>38</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>49</span><span class=p>,</span> <span class=mi>54</span><span class=p>],</span> <span class=p>[</span><span class=mi>37</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>53</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>58</span><span class=p>,</span> <span class=mi>38</span><span class=p>],</span>
</span></span><span class=line><span class=cl>     <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>27</span><span class=p>],</span> <span class=p>[</span><span class=mi>33</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>51</span><span class=p>,</span> <span class=mi>24</span><span class=p>],</span> <span class=p>[</span><span class=mi>16</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span> <span class=mi>42</span><span class=p>],</span>
</span></span><span class=line><span class=cl>     <span class=p>[</span><span class=mi>16</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>56</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>44</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>46</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xn</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&#34;x_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>58</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=n>PolynomialRing</span><span class=p>(</span><span class=n>GF</span><span class=p>(</span><span class=mi>67</span><span class=p>),</span> <span class=n>xn</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>xx</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>P</span><span class=o>.</span><span class=n>gens</span><span class=p>())[:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>varss</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>P</span><span class=o>.</span><span class=n>gens</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>xx</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>map_print</span><span class=p>[</span><span class=s2>&#34;}&#34;</span><span class=p>],</span> <span class=n>varss</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>],</span> <span class=n>varss</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>xxy</span> <span class=o>=</span> <span class=p>[</span><span class=n>map_print</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=s2>&#34;ictf{&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>xx</span> <span class=o>=</span> <span class=n>xxy</span> <span class=o>+</span> <span class=n>xx</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=n>xx</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span> <span class=o>+</span> <span class=mi>8</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>8</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>a_m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b_m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x_m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>amat</span> <span class=o>=</span> <span class=n>matmul</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>amat_m</span> <span class=o>=</span> <span class=n>a_m</span> <span class=o>*</span> <span class=n>x_m</span>
</span></span><span class=line><span class=cl><span class=n>bmat</span> <span class=o>=</span> <span class=n>matmul</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>bmat_m</span> <span class=o>=</span> <span class=n>x_m</span> <span class=o>*</span> <span class=n>b_m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>states</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>amat</span><span class=p>,</span> <span class=n>bmat</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>states</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>mapv</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>varss</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>mapv</span><span class=p>[</span><span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>58</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>64</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>64</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>states</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=n>c</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>j</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>m</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>mapv</span><span class=p>[</span><span class=n>j</span><span class=p>[</span><span class=mi>1</span><span class=p>]]]</span> <span class=o>=</span> <span class=n>j</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=n>j</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>matrix</span><span class=p>(</span><span class=n>F</span><span class=p>,</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=n>vector</span><span class=p>(</span><span class=n>GF</span><span class=p>(</span><span class=mi>67</span><span class=p>),</span> <span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>solve_right</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>56</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;ictf{&#34;</span>
</span></span><span class=line><span class=cl><span class=n>k</span> <span class=o>=</span> <span class=p>[</span><span class=n>printable</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>res</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>+=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span> <span class=o>+</span> <span class=s1>&#39;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ictf{who_need_javascript_when_you_can_do_it_all_in_typescript}</span>
</span></span></code></pre></td></tr></table></div></div><p>Flag is: <strong>ictf{who_need_javascript_when_you_can_do_it_all_in_typescript}</strong></p><p>After having solved it, he had a short comment on the challenge xD</p><img src=3.png alt width=600><h2 id=appendix>Appendix</h2><p>The challenges for this year&rsquo;s edition were quite fun to do, our team had a good time solving them together.</p><p>If you have any question regarding the above solutions, you can DM me via my <a href=https://twitter.com/FazeCT1512 target=_blank rel="noopener noreffer">Twitter</a>
or my <code>Discord</code> (FazeCT #fazect).</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-07-24</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/imaginaryctf2023-rev/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://fazect.github.io/imaginaryctf2023-rev/ data-title="ImaginaryCTF 2023 - Reverse Engineering Writeups" data-hashtags=RE,ImaginaryCTF,english><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://fazect.github.io/imaginaryctf2023-rev/ data-hashtag=RE><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://fazect.github.io/imaginaryctf2023-rev/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/re/>RE</a>,&nbsp;<a href=/tags/imaginaryctf/>ImaginaryCTF</a>,&nbsp;<a href=/tags/english/>english</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/amateursctf2023-rev/ class=prev rel=prev title="amateursCTF 2023 - Reverse Engineering Writeups"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>amateursCTF 2023 - Reverse Engineering Writeups</a>
<a href=/sekaictf2023-sfc/ class=next rel=next title="SekaiCTF 2023 - Sahuang Flag Checker">SekaiCTF 2023 - Sahuang Flag Checker<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.120.1">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://fazect.github.io/ target=_blank>FazeCT</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>