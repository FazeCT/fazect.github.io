<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>amateursCTF 2023 - Reverse Engineering Writeups - FazeCT Blogs</title><meta name=Description content="Solutions to ALL reverse engineering challenges in the event."><meta property="og:title" content="amateursCTF 2023 - Reverse Engineering Writeups"><meta property="og:description" content="Solutions to ALL reverse engineering challenges in the event."><meta property="og:type" content="article"><meta property="og:url" content="https://fazect.github.io/amateursctf2023-rev/"><meta property="og:image" content="https://fazect.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-20T08:15:00+07:00"><meta property="article:modified_time" content="2023-07-20T08:15:00+07:00"><meta property="og:site_name" content="FazeCT blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fazect.github.io/logo.png"><meta name=twitter:title content="amateursCTF 2023 - Reverse Engineering Writeups"><meta name=twitter:description content="Solutions to ALL reverse engineering challenges in the event."><meta name=application-name content="CTF Blogs"><meta name=apple-mobile-web-app-title content="CTF Blogs"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://fazect.github.io/amateursctf2023-rev/><link rel=prev href=https://fazect.github.io/zer0ptsctf2023-rev/><link rel=next href=https://fazect.github.io/imaginaryctf2023-rev/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"amateursCTF 2023 - Reverse Engineering Writeups","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/fazect.github.io\/amateursctf2023-rev\/"},"genre":"posts","keywords":"RE, amateursCTF, english","wordcount":5427,"url":"https:\/\/fazect.github.io\/amateursctf2023-rev\/","datePublished":"2023-07-20T08:15:00+07:00","dateModified":"2023-07-20T08:15:00+07:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"FazeCT"},"description":"Solutions to ALL reverse engineering challenges in the event."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="FazeCT Blogs">Blogs</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/aboutme/>About Me </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="FazeCT Blogs">Blogs</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/aboutme/ title>About Me</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">amateursCTF 2023 - Reverse Engineering Writeups</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://fazect.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>FazeCT</a>
</span>&nbsp;<span class=post-category>included in <a href=/categories/writeups/><i class="far fa-folder fa-fw" aria-hidden=true></i>Writeups</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-07-20>2023-07-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;5427 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;26 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#volcano>volcano</a></li><li><a href=#rusteze>rusteze</a></li><li><a href=#trick-question>trick question</a></li><li><a href=#headache>headache</a></li><li><a href=#csce221-data-structures-and-algorithms>CSCE221-Data Structures and Algorithms</a></li><li><a href=#jvm>jvm</a></li><li><a href=#rusteze-2>rusteze 2</a></li><li><a href=#flagchecker>flagchecker</a></li><li><a href=#heading>üè¥‚ùìüá®üáπüá´</a></li><li><a href=#jsrev>jsrev</a></li><li><a href=#appendix>Appendix</a></li></ul></nav></div></div><div class=content id=content><p>Solutions to ALL reverse engineering challenges in the event.</p><h2 id=overview>Overview</h2><p>Last weekend, I had the opportunity to participate in the event with my team, <code>NEW JEANS FC</code> (aka <code>thehackerscrew</code>), where I did all the reverse engineering challenges!</p><p>I want to give a big shoutout to the authors, and especially <code>flocto</code>, for creating such cool reverse challenges!</p><p>All of the challenges&rsquo; binaries can be found here: <a href=https://github.com/FazeCT/ctf/tree/main/amateursCTF%202023 target=_blank rel="noopener noreffer">Click me!</a></p><h2 id=volcano>volcano</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>volcano</code></li><li><strong>Description:</strong> Inspired by recent &ldquo;traumatic&rdquo; events.</li></ul></div></div></div><p>We are given a binary file named <code>volcano</code>. Load it in your favorite tool (mine was <code>IDA</code>) and get ready for our first task!</p><img src=1.png alt width=1000><p>The program prompts user for <code>3</code> numeral inputs.</p><p>First input is checked using the below function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=n>_BOOL8</span> <span class=kr>__fastcall</span> <span class=nf>check_first</span><span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=n>input</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>input</span> <span class=o>%</span> <span class=mi>3</span> <span class=o>!=</span> <span class=mi>2</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>input</span> <span class=o>%</span> <span class=mi>5</span> <span class=o>!=</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>input</span> <span class=o>%</span> <span class=mi>7</span> <span class=o>==</span> <span class=mi>3</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>input</span> <span class=o>%</span> <span class=mh>0x6D</span> <span class=o>==</span> <span class=mi>55</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>By using some math (or even trial and error), we can easily point out that there are a lot of solutions to this in the form of <code>18476 + 22890 * n</code>.</p><p>Second input is checked using the below function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=n>_BOOL8</span> <span class=kr>__fastcall</span> <span class=nf>check_second</span><span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>v2</span><span class=p>;</span> <span class=c1>// [rsp+8h] [rbp-10h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v2</span> <span class=o>=</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span> <span class=n>input</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>v2</span> <span class=o>+=</span> <span class=n>input</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>input</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>v2</span> <span class=o>&gt;</span> <span class=mh>0x10</span> <span class=o>&amp;&amp;</span> <span class=n>v2</span> <span class=o>&lt;=</span> <span class=mh>0x1A</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>This function maybe harder for analyzing than the first, but it is just counting number of set bits (<code>1</code> bits) of the input.</p><p>Third input is used in several functions to compare first two inputs.</p><p>And to solve this challenge, it is really simple to just write a script to find a 64-bit number that satisfies both constraints, and I used this script below to get it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>18476</span><span class=p>,</span> <span class=mi>2</span> <span class=o>**</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>22890</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=mh>0x10</span> <span class=o>&lt;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=mh>0x14</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>From the list of results, I chose <code>26264942966</code> to send for the first two inputs, and randomly chose <code>1337</code> for the third input.</p><img src=2.png alt width=1000><p>Flag is: <strong>amateursCTF{yep_th0se_l00k_th3_s4me_to_m3!_:clueless:}</strong></p><h2 id=rusteze>rusteze</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>rusteze</code></li><li><strong>Description:</strong> Get rid of all your Rust rust with this brand new Rust-eze‚Ñ¢ de-ruster. Flag is <code>amateursCTF{[a-zA-Z0-9_]+}</code>.</li></ul></div></div></div><p>We are provided a binary named <code>rusteze</code>. Again, load it using a decompiler of your choice and seek for the main function.</p><p>The program wants us to input in a string with length <code>38</code>. Then it initiates <code>2</code> arrays also of size <code>38</code> each (I will call them <code>a</code> and <code>b</code>).</p><p>The input is checked like this:</p><p><code>assert rol(input[i] ^ a[i], 2) == b[i]</code></p><p>Knowing that, I dumped out <code>2</code> arrays and used this script to solve for the input.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>b</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=n>k</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>:]</span> <span class=o>+</span> <span class=n>k</span><span class=p>[:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=nb>chr</span><span class=p>(</span><span class=n>a</span> <span class=o>^</span> <span class=nb>int</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=mi>2</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>arr_1</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>39</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>105</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>87</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>87</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=mi>117</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=mi>102</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=mi>62</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=mi>27</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>=</span> <span class=mi>99</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>29</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>96</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>=</span> <span class=mi>115</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>89</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>=</span> <span class=mi>67</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>113</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>32</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>70</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>64</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>22</span><span class=p>]</span> <span class=o>=</span> <span class=mi>84</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>23</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>103</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>24</span><span class=p>]</span> <span class=o>=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>25</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>65</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>26</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>97</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>27</span><span class=p>]</span> <span class=o>=</span> <span class=mi>47</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>28</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>60</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>29</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>86</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>30</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>90</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>31</span><span class=p>]</span> <span class=o>=</span> <span class=mi>116</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>32</span><span class=p>]</span> <span class=o>=</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>33</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>35</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>34</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>105</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>35</span><span class=p>]</span> <span class=o>=</span> <span class=mi>34</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>36</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>19</span>
</span></span><span class=line><span class=cl><span class=n>arr_1</span><span class=p>[</span><span class=mi>37</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>59</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>25</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>21</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>40</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;V&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>3</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>4</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>53</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>5</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>97</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>6</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>36</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>7</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>106</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>8</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>111</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>9</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>75</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>10</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>11</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>92</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>12</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>122</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>13</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>85</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>14</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>24</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>15</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>16</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>86</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>17</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>105</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>18</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>34</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>19</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>99</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>20</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>81</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>21</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>44</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>22</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>71</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>23</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>81</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>24</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>63</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>25</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>62</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>26</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>106</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>27</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>90</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>28</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>84</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>29</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>79</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>30</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>94</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>31</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>118</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>32</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>89</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>33</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>82</span>
</span></span><span class=line><span class=cl><span class=n>arr_2</span><span class=p>[</span><span class=mi>34</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>30</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>38</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>solve</span><span class=p>(</span><span class=n>arr_1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=n>arr_2</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ama¬ïeursCTF{h0pe_y0u_w3r3nt_t00_ru5ty}</span>
</span></span></code></pre></td></tr></table></div></div><p>There was something wrong with the first part of the flag but it doesn&rsquo;t matter, and I was also lazy to recheck it.</p><p>Flag is: <strong>amateursCTF{h0pe_y0u_w3r3nt_t00_ru5ty}</strong></p><h2 id=trick-question>trick question</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>trick-question.pyc</code></li><li><strong>Description:</strong> Which one do you hate more: decompiling pycs or reading Python bytecode disassembly? Just kidding that&rsquo;s a trick question. Run with Python version <code>3.10</code>. Flag is <code>amateursCTF{[a-zA-Z0-9_]+}</code>.</li></ul></div></div></div><p>For this challenge, we are given a python bytecode file. I used <a href=https://github.com/zrax/pycdc target=_blank rel="noopener noreffer">pycdc</a>
as always to decompile the <code>.pyc</code> file and got this python source.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=c1># Source Generated with Decompyle++</span>
</span></span><span class=line><span class=cl><span class=c1># File: trick-question.pyc (Python 3.10)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>b64decode</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;exec&#39;</span><span class=p>](</span><span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;__import__&#39;</span><span class=p>](</span><span class=s1>&#39;base64&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;gIHByaW50KCJJbmNvcnJlY3QuIik=&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;gcHJpbnQoIkNvcnJlY3QhIikKZWxzZToKIC&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;CIgogOpkiIgozZhxmZgUGa0BiclRnbFJCK0VHculGKrNWZoNGImlmCp0HZpBiOnQWansHIsUGZvNGKps2Ylh2YoUGc5RHI9&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;ya1x4MDNyXHgwZXRceD&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;xXHg4NVx4MDJceDE5XHgwMGRceD&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Y2hlY2sgPSBsYW1iZGE6Tm9uZQpjb2RlID0gdHlwZShjaGVjay5fX2NvZGVfXykoMSwgMCwgMCwgNiwgNSwgNjcsIGInfFx4MDBkXHgwMGRceD&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>r</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>r</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>b64decode</span><span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>x</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span>
</span></span></code></pre></td></tr></table></div></div><p>Next thing I did was taking the result of this <code>'A'.join(x[::-1])</code> and threw it in an online decoder so that we can get raw code instead of running it (a good online decoder can be found here: <a href=https://gchq.github.io/CyberChef/ target=_blank rel="noopener noreffer">CyberChef</a>
). I got this as a result:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>check</span> <span class=o>=</span> <span class=k>lambda</span><span class=p>:</span><span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=n>code</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>check</span><span class=o>.</span><span class=vm>__code__</span><span class=p>)(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x01\x85\x02\x19\x00</span><span class=s1>d</span><span class=se>\x02</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>r</span><span class=se>\x0e</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x04\x19\x00</span><span class=s1>d</span><span class=se>\x05</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>r</span><span class=se>\x1a</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x01</span><span class=s1>d</span><span class=se>\x04\x85\x02\x19\x00</span><span class=s1>}</span><span class=se>\x00</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x06\x19\x00</span><span class=s1>|</span><span class=se>\x00\x83\x01</span><span class=s1>d</span><span class=se>\x07</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>r0t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>g</span><span class=se>\x00</span><span class=s1>}</span><span class=se>\x01</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x08\x19\x00</span><span class=s1>|</span><span class=se>\x00\x83\x01</span><span class=s1>D</span><span class=se>\x00</span><span class=s1>]</span><span class=se>\r\\\x02</span><span class=s1>}</span><span class=se>\x02</span><span class=s1>}</span><span class=se>\x03</span><span class=s1>|</span><span class=se>\x03</span><span class=s1>d</span><span class=se>\t</span><span class=s1>k</span><span class=se>\x02</span><span class=s1>rG|</span><span class=se>\x01\xa0\x03</span><span class=s1>|</span><span class=se>\x02\xa1\x01\x01\x00</span><span class=s1>q:|</span><span class=se>\x01</span><span class=s1>g</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\n\xa2\x01</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>rTt</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>|</span><span class=se>\x00\xa0\x04\xa1\x00\xa0\x05</span><span class=s1>d</span><span class=se>\x0b\xa1\x01</span><span class=s1>}</span><span class=se>\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0c\x19\x00</span><span class=s1>d</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x04\x85\x03\x19\x00</span><span class=s1>d</span><span class=se>\r</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>rlt</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0c\x19\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00\x17\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0f\x19\x00\x18\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0f\x19\x00\x17\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0c\x19\x00\x18\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0f\x19\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0c\x19\x00\x17\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00</span><span class=s1>d</span><span class=se>\x0e\x19\x00\x18\x00</span><span class=s1>f</span><span class=se>\x03</span><span class=s1>d</span><span class=se>\x10</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>r</span><span class=se>\xa9</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x11\x19\x00</span><span class=s1>d</span><span class=se>\x12\x83\x01\xa0\x06</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0f\x19\x00\xa1\x01\xa0\x07\xa1\x00</span><span class=s1>d</span><span class=se>\x13</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>r</span><span class=se>\xc0</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x11\x19\x00</span><span class=s1>d</span><span class=se>\x14\x83\x01</span><span class=s1>}</span><span class=se>\x04</span><span class=s1>|</span><span class=se>\x04\xa0\x08</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0f\x19\x00\xa1\x01\x01\x00</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x15\x19\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x16\x19\x00\x83\x01</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x16</span><span class=s1>&lt;</span><span class=se>\x00</span><span class=s1>|</span><span class=se>\x04\xa0\t</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x16\x19\x00\xa1\x01\x01\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x16\x19\x00</span><span class=s1>g</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x17\xa2\x01</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>r</span><span class=se>\xf0</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x18\x19\x00</span><span class=s1>d</span><span class=se>\x19\x17\x00</span><span class=s1>d</span><span class=se>\x1a</span><span class=s1>k</span><span class=se>\x03</span><span class=s1>r</span><span class=se>\xfe</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x1b\x19\x00\xa0\n</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x1c\x19\x00</span><span class=s1>d</span><span class=se>\x0c</span><span class=s1>d</span><span class=se>\x18\x85\x02\x19\x00</span><span class=s1>d</span><span class=se>\x1d\xa1\x02</span><span class=s1>|</span><span class=se>\x04\xa0\x0b</span><span class=s1>d</span><span class=se>\x0c</span><span class=s1>d</span><span class=se>\x1e\xa1\x02</span><span class=s1>A</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x1f</span><span class=s1>k</span><span class=se>\x03\x90\x01</span><span class=s1>r</span><span class=se>\x1d</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x1b\x19\x00\xa0\n</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x1c\x19\x00</span><span class=s1>d</span><span class=se>\x18</span><span class=s1>d </span><span class=se>\x85\x02\x19\x00</span><span class=s1>d</span><span class=se>\x1d\xa1\x02</span><span class=s1>|</span><span class=se>\x04\xa0\x0b</span><span class=s1>d</span><span class=se>\x0c</span><span class=s1>d</span><span class=se>\x1e\xa1\x02</span><span class=s1>A</span><span class=se>\x00</span><span class=s1>d!k</span><span class=se>\x03\x90\x01</span><span class=s1>r&lt;t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x1b\x19\x00\xa0\n</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x1c\x19\x00</span><span class=s1>d d</span><span class=se>\x01\x85\x02\x19\x00</span><span class=s1>d&#34;</span><span class=se>\x17\x00</span><span class=s1>d</span><span class=se>\x1d\xa1\x02</span><span class=s1>|</span><span class=se>\x04\xa0\x0b</span><span class=s1>d</span><span class=se>\x0c</span><span class=s1>d</span><span class=se>\x1e\xa1\x02</span><span class=s1>A</span><span class=se>\x00</span><span class=s1>d#k</span><span class=se>\x03\x90\x01</span><span class=s1>r]t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x0c</span><span class=s1>}</span><span class=se>\x05</span><span class=s1>|</span><span class=se>\x00</span><span class=s1>d$</span><span class=se>\x19\x00</span><span class=s1>D</span><span class=se>\x00</span><span class=s1>]</span><span class=se>\x0b</span><span class=s1>}</span><span class=se>\x02</span><span class=s1>|</span><span class=se>\x05</span><span class=s1>d%9</span><span class=se>\x00</span><span class=s1>}</span><span class=se>\x05</span><span class=s1>|</span><span class=se>\x05</span><span class=s1>|</span><span class=se>\x02</span><span class=s1>7</span><span class=se>\x00</span><span class=s1>}</span><span class=se>\x05\x90\x01</span><span class=s1>qct</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d&amp;</span><span class=se>\x19\x00</span><span class=s1>|</span><span class=se>\x05\x83\x01</span><span class=s1>d</span><span class=se>\&#39;</span><span class=s1>k</span><span class=se>\x03\x90\x01</span><span class=s1>r</span><span class=se>\x80</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d</span><span class=se>\x03\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>t</span><span class=se>\x00</span><span class=s1>j</span><span class=se>\x01</span><span class=s1>j</span><span class=se>\x02</span><span class=s1>d(</span><span class=se>\x19\x00</span><span class=s1>S</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=s1>&#39;amateursCTF{&#39;</span><span class=p>,</span> <span class=s1>&#39;False&#39;</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;}&#39;</span><span class=p>,</span> <span class=s1>&#39;len&#39;</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span> <span class=s1>&#39;enumerate&#39;</span><span class=p>,</span> <span class=s1>&#39;_&#39;</span><span class=p>,</span> <span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>35</span><span class=p>),</span> <span class=sa>b</span><span class=s1>&#39;_&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;sn0h7YP&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=p>(</span><span class=mi>160</span><span class=p>,</span> <span class=mi>68</span><span class=p>,</span> <span class=mi>34</span><span class=p>),</span> <span class=s1>&#39;__import__&#39;</span><span class=p>,</span> <span class=s1>&#39;hashlib&#39;</span><span class=p>,</span> <span class=s1>&#39;4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a&#39;</span><span class=p>,</span> <span class=s1>&#39;random&#39;</span><span class=p>,</span> <span class=s1>&#39;list&#39;</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=p>(</span><span class=mi>49</span><span class=p>,</span> <span class=mi>89</span><span class=p>,</span> <span class=mi>102</span><span class=p>,</span> <span class=mi>109</span><span class=p>,</span> <span class=mi>108</span><span class=p>,</span> <span class=mi>52</span><span class=p>),</span> <span class=mi>4</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;freebie&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;0ffreebie&#39;</span><span class=p>,</span> <span class=s1>&#39;int&#39;</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>,</span> <span class=mi>4294967295</span><span class=p>,</span> <span class=mi>4227810561</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>825199122</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=mi>4277086886</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=s1>&#39;hex&#39;</span><span class=p>,</span> <span class=s1>&#39;0x29ee69af2f3&#39;</span><span class=p>,</span> <span class=s1>&#39;True&#39;</span><span class=p>,</span> <span class=s1>&#39;Did you know? pycdc can decompile marshaled code objects. Just make sure you mention the right version!&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;__self__&#39;</span><span class=p>,</span> <span class=s1>&#39;__dict__&#39;</span><span class=p>,</span> <span class=s1>&#39;append&#39;</span><span class=p>,</span> <span class=s1>&#39;encode&#39;</span><span class=p>,</span> <span class=s1>&#39;split&#39;</span><span class=p>,</span> <span class=s1>&#39;sha256&#39;</span><span class=p>,</span> <span class=s1>&#39;hexdigest&#39;</span><span class=p>,</span> <span class=s1>&#39;seed&#39;</span><span class=p>,</span> <span class=s1>&#39;shuffle&#39;</span><span class=p>,</span> <span class=s1>&#39;from_bytes&#39;</span><span class=p>,</span> <span class=s1>&#39;randint&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;input&#39;</span><span class=p>,</span> <span class=s1>&#39;underscores&#39;</span><span class=p>,</span> <span class=s1>&#39;i&#39;</span><span class=p>,</span> <span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>),</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;check&#39;</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x10\x01\x0c\x01\x0c\x01\x0c\x01\x0c\x01\x14\x02\x0c\x01\x04\x02\x18\x01\x08\x01\n\x01\x02\x80\x0c\x01\x0c\x01\x0e\x02\x16\x01\x0c\x01</span><span class=s1>n</span><span class=se>\x03\x0c\x01</span><span class=s1>&#34;</span><span class=se>\x02\x0c\x01\x10\x02\x0e\x01\x18\x01\x0e\x01\x10\x02\x0c\x01\x10\x02\x0c\x01</span><span class=s1>2</span><span class=se>\x02\x0c\x01</span><span class=s1>2</span><span class=se>\x02\x0c\x01</span><span class=s1>6</span><span class=se>\x02\x0c\x01\x04\x02\x0c\x01\x08\x01\x0c\x01\x16\x02\x0c\x01\x0c\x02</span><span class=s1>&#39;</span><span class=p>,</span> <span class=p>(),</span> <span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>check</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>check</span><span class=p>)(</span><span class=n>code</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=nb>id</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>check</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter the flag: &#34;</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Correct!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Incorrect.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>There is a hint in the source above of what we should do next. which is <code>Did you know? pycdc can decompile marshaled code objects</code>. So we dump out the marshaled code object, then use <code>pycdc</code> again to decompile it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>marshal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;D:/ctf/revChalls/amateursCTF/dump.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>check</span> <span class=o>=</span> <span class=k>lambda</span><span class=p>:</span><span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=n>code</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>check</span><span class=o>.</span><span class=vm>__code__</span><span class=p>)(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;|</span><span class=se>\x00</span><span class=s1>d</span><span class=se>\x00</span><span class=s1>d[...]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>marshal</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>code</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>Use the below command to decompile the marshaled code object.</p><p><code>./pycdc -c -v 3.10 /[Replace this with your path!]/dump.txt</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=c1># Source Generated with Decompyle++</span>
</span></span><span class=line><span class=cl><span class=c1># File: dump.txt (Python 3.10)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>input</span><span class=p>[:</span><span class=mi>12</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;amateursCTF{&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=kc>None</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;}&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>input</span> <span class=o>=</span> <span class=kc>None</span><span class=p>[</span><span class=mi>12</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;len&#39;</span><span class=p>](</span><span class=nb>input</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>42</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>underscores</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;enumerate&#39;</span><span class=p>](</span><span class=nb>input</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x</span> <span class=o>==</span> <span class=s1>&#39;_&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>underscores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>underscores</span> <span class=o>!=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mi>7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>11</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>13</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>23</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>35</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>input</span> <span class=o>=</span> <span class=kc>None</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;_&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>input</span><span class=p>[</span><span class=mi>0</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=sa>b</span><span class=s1>&#39;sn0h7YP&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=kc>None</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=nb>input</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=nb>input</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>2</span><span class=p>],</span> <span class=nb>input</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=nb>input</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>-</span> <span class=nb>input</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=nb>input</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=nb>input</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=nb>input</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>])</span> <span class=o>!=</span> <span class=p>(</span><span class=mi>160</span><span class=p>,</span> <span class=mi>68</span><span class=p>,</span> <span class=mi>34</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=kc>None</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;__import__&#39;</span><span class=p>](</span><span class=s1>&#39;hashlib&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=nb>input</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span> <span class=o>!=</span> <span class=s1>&#39;4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=kc>None</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;__import__&#39;</span><span class=p>](</span><span class=s1>&#39;random&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=nb>input</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>input</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;list&#39;</span><span class=p>](</span><span class=nb>input</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>shuffle</span><span class=p>(</span><span class=nb>input</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>input</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>!=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mi>49</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>89</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>102</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>109</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>108</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>52</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=kc>None</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;freebie&#39;</span> <span class=o>!=</span> <span class=sa>b</span><span class=s1>&#39;0ffreebie&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=kc>None</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;int&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=nb>input</span><span class=p>[</span><span class=mi>5</span><span class=p>][</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>],</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>^</span> <span class=n>r</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mh>0xFFFFFFFF</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0xFBFF4501</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=kc>None</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;int&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=nb>input</span><span class=p>[</span><span class=mi>5</span><span class=p>][</span><span class=mi>4</span><span class=p>:</span><span class=mi>8</span><span class=p>],</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>^</span> <span class=n>r</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mh>0xFFFFFFFF</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>825199122</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=kc>None</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;int&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>from_bytes</span><span class=p>(</span><span class=nb>input</span><span class=p>[</span><span class=mi>5</span><span class=p>][</span><span class=mi>8</span><span class=p>:</span><span class=mi>12</span><span class=p>]</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>^</span> <span class=n>r</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mh>0xFFFFFFFF</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0xFEEF2AA6</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>input</span><span class=p>[</span><span class=mi>6</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>*=</span> <span class=mi>128</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>+=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;hex&#39;</span><span class=p>](</span><span class=n>c</span><span class=p>)</span> <span class=o>!=</span> <span class=s1>&#39;0x29ee69af2f3&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>id</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;False&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=kc>None</span><span class=o>.</span><span class=vm>__self__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;True&#39;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>From this, I wrote a script to solve each part of the input.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;amateursCTF{&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Part 1:</span>
</span></span><span class=line><span class=cl><span class=n>flag</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=s1>&#39;sn0h7YP&#39;</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Part 2: (I used calculator to solve it)</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>97</span><span class=p>,</span> <span class=mi>114</span><span class=p>,</span> <span class=mi>51</span><span class=p>])]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Part 3: (I used online crackers to solve it)</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;4&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Part 4: (I solved this using brain lol)</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;f4m1lY&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Part 5:</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>+=</span> <span class=p>[</span><span class=s1>&#39;0f&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Part 6:</span>
</span></span><span class=line><span class=cl><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;4&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;f4m1lY&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>random</span><span class=o>.</span><span class=n>shuffle</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>+=</span> <span class=p>[</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mh>0xFFFFFFFF</span><span class=p>)</span> <span class=o>^</span> <span class=mh>0xFBFF4501</span><span class=p>)[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>         <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mh>0xFFFFFFFF</span><span class=p>)</span> <span class=o>^</span> <span class=mi>825199122</span><span class=p>)[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>        <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mh>0xFFFFFFFF</span><span class=p>)</span> <span class=o>^</span> <span class=mh>0xFEEF2AA6</span><span class=p>)[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Part 7:</span>
</span></span><span class=line><span class=cl><span class=n>val</span> <span class=o>=</span> <span class=mh>0x29ee69af2f3</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>val</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>val</span> <span class=o>%</span> <span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>val</span> <span class=o>//=</span> <span class=mi>128</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>+=</span> <span class=p>[</span><span class=n>res</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># amateursCTF{PY7h0ns_ar3_4_f4m1lY_0f_N0Nv3nom0us_Sn4kes}</span>
</span></span></code></pre></td></tr></table></div></div><p>Flag is: <strong>amateursCTF{PY7h0ns_ar3_4_f4m1lY_0f_N0Nv3nom0us_Sn4kes}</strong></p><h2 id=headache>headache</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>headache</code></li><li><strong>Description:</strong> Ugh&mldr; my head hurts&mldr; Flag is <code>amateursCTF{[a-zA-Z0-9_]+}</code></li></ul></div></div></div><p>We are provided with a binary named <code>headache</code>. Using decompilers, we can see that the input should has length of <code>61</code>. Dug a bit further into the checker, I see that this binary is a <code>self-modifying binary</code>.</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>What is self-modifying binary<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>A binary that self constructs during runtime (modifies its content to turn raw data into opcodes).</div></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=kr>__int64</span> <span class=kr>__fastcall</span> <span class=nf>sub_401290</span><span class=p>(</span><span class=n>_BYTE</span> <span class=o>*</span><span class=n>a1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>_DWORD</span> <span class=o>*</span><span class=n>v2</span><span class=p>;</span> <span class=c1>// rsi
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=o>*</span><span class=n>a1</span> <span class=o>^</span> <span class=n>a1</span><span class=p>[</span><span class=mi>25</span><span class=p>])</span> <span class=o>!=</span> <span class=mi>86</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v2</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>loc_4012A4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>v2</span><span class=o>++</span> <span class=o>^=</span> <span class=mh>0xEA228DE6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span> <span class=o>*</span><span class=p>(</span><span class=n>v2</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>366834202</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>((</span><span class=kr>__int64</span> <span class=p>(</span><span class=o>*</span><span class=p>)(</span><span class=kt>void</span><span class=p>))</span><span class=n>loc_4012A4</span><span class=p>)();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>So, how exactly this program works? Firstly, we can see that it checks whether <code>input[0] ^ input[25] == 0x56</code>. If that satisfies, the binary does some <code>XOR</code> operations to reveal new codes and call them. And after doing some debugging, I could see the scheme of this challenge.</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>How the challenge works<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>It keeps checking the input&rsquo;s character pairs by pairs using <code>bitwise XOR</code> and compares the result with a constant. If they are equal, a new code section is unlocked - which also does the same thing, and the program calls it. Doing so for a reasonable amount of times, a set of constraint for the input is built.</div></div></div><p>So how we gonna solve this? At first I was thinking of using <code>angr</code>, but I failed to do so (again, <code>zer0ptsCTF 2023</code> flashbacks if you guys have read my last blog on that CTF), so I took the looooooong path of debugging and <code>Z3</code> (which was really painful). While debugging, you can modify <code>ZF</code> runtime to skip the comparisons and come to the self-modifying parts.</p><p>And, here is the script after all that debugging. (I also cheesed the flag and guessed it without putting all constraints in to save some time).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=n>BitVec</span><span class=p>(</span><span class=s1>&#39;x</span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=mi>8</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>61</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>61</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>127</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>12</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;amateursCTF{&#39;</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;}&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>^</span> <span class=n>a</span><span class=p>[</span><span class=mi>25</span><span class=p>]</span> <span class=o>==</span> <span class=mh>0x56</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mh>0x0E</span><span class=p>]</span> <span class=o>^</span> <span class=n>a</span><span class=p>[</span><span class=mh>0x2D</span><span class=p>]</span> <span class=o>==</span> <span class=mh>0x1D</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mh>0x21</span><span class=p>]</span> <span class=o>^</span> <span class=n>a</span><span class=p>[</span><span class=mh>0x22</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mh>0x28</span><span class=p>]</span> <span class=o>^</span> <span class=n>a</span><span class=p>[</span><span class=mh>0x34</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mh>0x0C</span><span class=p>]</span> <span class=o>^</span> <span class=n>a</span><span class=p>[</span><span class=mh>0x38</span><span class=p>]</span> <span class=o>==</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mh>0x0B</span><span class=p>]</span> <span class=o>^</span> <span class=n>a</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=mh>0x1e</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sol_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>s</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span> <span class=ow>and</span> <span class=n>sol_count</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>61</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=nb>chr</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span><span class=o>.</span><span class=n>as_long</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>sol_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>cond</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>61</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>cond</span> <span class=o>=</span> <span class=n>And</span><span class=p>(</span><span class=n>cond</span><span class=p>,</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>result</span><span class=p>[</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Not</span><span class=p>(</span><span class=n>cond</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># amateursCTF{i_h4v3_a_spli77ing_headache_1_r3qu1re_m04r_sl33p}</span>
</span></span></code></pre></td></tr></table></div></div><p>Flag is: <strong>amateursCTF{i_h4v3_a_spli77ing_headache_1_r3qu1re_m04r_sl33p}</strong></p><h2 id=csce221-data-structures-and-algorithms>CSCE221-Data Structures and Algorithms</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>csce221.tar.gz</code></li><li><strong>Description:</strong> I was doing some homework for my Data Structures and Algorithms class, but my program unexpectedly crashed when I entered in my flag. Could you help me get it back? Here&rsquo;s the coredump and the binary, I&rsquo;ll even toss in the header file. Can&rsquo;t give out the source code though, how do I know you won&rsquo;t cheat off me?</li></ul></div></div></div><p>For this challenge, I had an <del>unintended</del> intended solution (confirmed by the author himself that this is intended, I just took the shorter route instead) to just view the <code>main.coredump</code> file to get the flag.</p><img src=3.png alt width=1000><p>Sorry <code>flocto</code> for that!</p><p>Flag is: <strong>amateursCTF{l1nk3d_bY_4n_xor}</strong></p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>Appendix<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>I looked at <code>main</code> and the <code>header</code> before, and combined with the flag&rsquo;s content, probably the author&rsquo;s intended solution is to mix <code>bitwise XOR</code> and <code>linked list data structures</code>?</div></div></div><h2 id=jvm>jvm</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>JVM.class</code> and <code>code.jvm</code></li><li><strong>Description:</strong> I heard my professor talking about some &ldquo;Java Virtual Machine&rdquo; and its weird gimmicks, so I took it upon myself to complete one. It wasn&rsquo;t even that hard? I don&rsquo;t know why he was complaining about it so much. Compiled with <code>openjdk 11.0.19</code>. Run with <code>java JVM code.jvm</code>.</li></ul></div></div></div><p>For this problem, we have two files, <code>JVM.class</code> and <code>code.jvm</code>. View <code>JVM.class</code> in <a href=https://github.com/skylot/jadx target=_blank rel="noopener noreffer">JADX</a>
, we can see that this is an another <code>VM</code> reversing challenge.</p><p>My way of tackling a <code>VM</code> challenge is to first, write a quick and dirty interpreter.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>vm</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;C:/Users/ADMIN/OneDrive/Desktop/temp/jvm/code.jvm&#34;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>vm</span> <span class=o>=</span> <span class=p>[</span><span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>vm</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ls</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>1024</span>
</span></span><span class=line><span class=cl><span class=n>ls2</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>i2</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>inp_stream</span> <span class=o>=</span> <span class=s1>&#39;amateursCTF</span><span class=si>{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>vm</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>op</span> <span class=o>=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>op</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>]],</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]],</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: swap ls2[</span><span class=si>{}</span><span class=s1>] and ls2[</span><span class=si>{}</span><span class=s1>].&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>+=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] += </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>9</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>+=</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] += ls2[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>12</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>-=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] -= </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>13</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>-=</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] -= ls2[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>*=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] *= </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>17</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>*=</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] *= ls2[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>20</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>//=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] //= </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>21</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>//=</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] //= ls2[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>24</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>%=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] %= </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>25</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>%=</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] %= ls2[</span><span class=si>{}</span><span class=s1>].&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>28</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>&lt;&lt;=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] &lt;&lt;= </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>29</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>&lt;&lt;=</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] &lt;&lt;= ls2[</span><span class=si>{}</span><span class=s1>].&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>31</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>inp_stream</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>inp_stream</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>inp_stream</span> <span class=o>=</span> <span class=n>inp_stream</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i4</span> <span class=o>=</span> <span class=n>i2</span>
</span></span><span class=line><span class=cl>        <span class=n>i2</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>ls</span><span class=p>[</span><span class=n>i4</span><span class=p>]</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>inp_stream</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>i4</span><span class=p>,</span> <span class=n>inp_stream</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>inp_stream</span> <span class=o>=</span> <span class=n>inp_stream</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>33</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: print(</span><span class=si>{}</span><span class=s1>).&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=nb>chr</span><span class=p>(</span><span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]])))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>34</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i2</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: print(</span><span class=si>{}</span><span class=s1>).&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=nb>chr</span><span class=p>(</span><span class=n>ls</span><span class=p>[</span><span class=n>i2</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>41</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: if </span><span class=si>{}</span><span class=s1> == 0, i set to </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>42</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: if ls2[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1> != 0, i set to vm[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]],</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>,</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>43</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: i set to vm[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>52</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i5</span> <span class=o>=</span> <span class=n>i2</span>
</span></span><span class=line><span class=cl>        <span class=n>i2</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>ls</span><span class=p>[</span><span class=n>i5</span><span class=p>]</span> <span class=o>=</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls[</span><span class=si>{}</span><span class=s1>] = ls2[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>i5</span><span class=p>,</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>ls</span><span class=p>[</span><span class=n>i5</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>53</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i2</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>ls</span><span class=p>[</span><span class=n>i2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls2[</span><span class=si>{}</span><span class=s1>] = ls[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>i2</span><span class=p>,</span> <span class=n>ls2</span><span class=p>[</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>54</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i6</span> <span class=o>=</span> <span class=n>i2</span>
</span></span><span class=line><span class=cl>        <span class=n>i2</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>ls</span><span class=p>[</span><span class=n>i6</span><span class=p>]</span> <span class=o>=</span> <span class=n>vm</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;op </span><span class=si>{}</span><span class=s1>: ls[</span><span class=si>{}</span><span class=s1>] = vm[</span><span class=si>{}</span><span class=s1>] = </span><span class=si>{}</span><span class=s1>.&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>vm</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>i6</span><span class=p>,</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>ls</span><span class=p>[</span><span class=n>i6</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>op</span> <span class=o>==</span> <span class=mi>255</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><p>After some trials and errors, I could see that the <code>VM</code> wants an input of length <code>45</code>. I tried <code>amateursCTF{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}</code> as an input, and got this result.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>op</span> <span class=mi>43</span><span class=p>:</span> <span class=n>i</span> <span class=nb>set</span> <span class=n>to</span> <span class=n>vm</span><span class=p>[</span><span class=mi>26</span><span class=p>]</span> <span class=o>=</span> <span class=mf>44.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>53</span><span class=p>:</span> <span class=n>ls2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>ls</span><span class=p>[</span><span class=mi>44</span><span class=p>]</span> <span class=o>=</span> <span class=mf>125.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>12</span><span class=p>:</span> <span class=n>ls2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=mf>125.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>42</span><span class=p>:</span> <span class=k>if</span> <span class=n>ls2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>i</span> <span class=nb>set</span> <span class=n>to</span> <span class=n>vm</span><span class=p>[</span><span class=mi>51</span><span class=p>]</span> <span class=o>=</span> <span class=mf>37.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>53</span><span class=p>:</span> <span class=n>ls2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>ls</span><span class=p>[</span><span class=mi>43</span><span class=p>]</span> <span class=o>=</span> <span class=mf>120.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>12</span><span class=p>:</span> <span class=n>ls2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=mf>9.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>12</span><span class=p>:</span> <span class=n>ls2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=mf>54.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>42</span><span class=p>:</span> <span class=k>if</span> <span class=n>ls2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>57</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>i</span> <span class=nb>set</span> <span class=n>to</span> <span class=n>vm</span><span class=p>[</span><span class=mi>62</span><span class=p>]</span> <span class=o>=</span> <span class=mf>37.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>54</span><span class=p>:</span> <span class=n>ls</span><span class=p>[</span><span class=mi>43</span><span class=p>]</span> <span class=o>=</span> <span class=n>vm</span><span class=p>[</span><span class=mi>38</span><span class=p>]</span> <span class=o>=</span> <span class=mf>79.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>54</span><span class=p>:</span> <span class=n>ls</span><span class=p>[</span><span class=mi>44</span><span class=p>]</span> <span class=o>=</span> <span class=n>vm</span><span class=p>[</span><span class=mi>40</span><span class=p>]</span> <span class=o>=</span> <span class=mf>78.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>34</span><span class=p>:</span> <span class=nb>print</span><span class=p>(</span><span class=n>N</span><span class=p>)</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>op</span> <span class=mi>34</span><span class=p>:</span> <span class=nb>print</span><span class=p>(</span><span class=n>O</span><span class=p>)</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><p>We can easily see that it is checking from our last character (which is our <code>}</code> character, and obviously I got it right). For the next character, it checks whether <code>char - 9 - 54 == 0</code>, and that evaluates to character <code>?</code>.</p><p>Knowing the algorithm, I solved each character one by one (without any script, I used <code>Python CLI</code>).</p><p>Also, there was a character that has a different checking technique, which I remember involving <code>2 ** 7</code> (left for the readers to find and solve it).</p><p>And, as we get <code>YES</code> outputted, there is our flag.</p><p>Flag is: <strong>amateursCTF{wh4t_d0_yoU_m34n_j4v4_isnt_A_vm?}</strong></p><h2 id=rusteze-2>rusteze 2</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>rusteze-2.exe</code></li><li><strong>Description:</strong> My boss said Linux binaries wouldn&rsquo;t reach enough customers so I was forced to make a Windows version. Flag is <code>amateursCTF{[a-zA-Z0-9_]+}</code>.</li></ul></div></div></div><p>We are given a Windows executable for this challenge. Load it in <code>IDA</code>, what I saw was a bunch of functions.</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>Well, what should we do then?<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>Normally, we can seek for main function. But in this case, we should seek for the strings that the executable outputs.</p><p>We can do so via <code>View > Open subviews > Strings</code>.</p><p>In this executable, we have two outputs <code>Wrong!</code> and <code>Correct!</code>. By clicking on their offsets then press <code>X</code>, you can view their xrefs and quickly get to the main encrypt function.</p></div></div></div><img src=4.png alt width=1000><p>The graph part above is our main target. First, it checks whether our input&rsquo;s length is <code>35</code> or not, then it calls <code>sub_1400029C0</code> for encryption.</p><p>Basically, the encryption is almost the same with <code>rusteze</code> challenge above but with a small twist, that is we have to input a <code>key</code> instead, and the flag will be in the memory of the program.</p><p>Here is how it works (with <code>a, b, c</code> are hardcoded arrays):</p><p><code>assert rol(key[i] ^ a[i], 2) == b[i]</code></p><p><code>flag[i] = a[i] ^ c[i] ^ key[i]</code></p><p>From that, we can conclude in: <code>flag[i] = rol(b[i], 6) ^ c[i]</code>.</p><p>Knowing the technique, I wrote a script to get the flag.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>rol</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>a</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span><span class=o>.</span><span class=n>rjust</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=n>k</span><span class=p>[</span><span class=mi>6</span><span class=p>:]</span> <span class=o>+</span> <span class=n>k</span><span class=p>[:</span><span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>210</span><span class=p>,</span> <span class=mi>165</span><span class=p>,</span> <span class=mi>246</span><span class=p>,</span> <span class=mi>177</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>108</span><span class=p>,</span> <span class=mi>51</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>132</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>198</span><span class=p>,</span> <span class=mi>143</span><span class=p>,</span> <span class=mi>132</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>123</span><span class=p>,</span> <span class=mi>163</span><span class=p>,</span> <span class=mi>191</span><span class=p>,</span> <span class=mi>118</span><span class=p>,</span> <span class=mi>180</span><span class=p>,</span> <span class=mi>203</span><span class=p>,</span> <span class=mi>166</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>124</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>219</span><span class=p>,</span> <span class=mi>245</span><span class=p>,</span> <span class=mi>108</span><span class=p>,</span> <span class=mi>149</span><span class=p>,</span> <span class=mi>125</span><span class=p>,</span> <span class=mi>86</span><span class=p>,</span> <span class=mi>97</span><span class=p>,</span> <span class=mi>133</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0x2F</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=p>[</span><span class=mi>134</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>153</span><span class=p>,</span> <span class=mi>204</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>183</span><span class=p>,</span> <span class=mi>57</span><span class=p>,</span> <span class=mi>197</span><span class=p>,</span> <span class=mi>190</span><span class=p>,</span> <span class=mi>243</span><span class=p>,</span> <span class=mi>171</span><span class=p>,</span> <span class=mi>93</span><span class=p>,</span> <span class=mi>144</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>76</span><span class=p>,</span> <span class=mi>175</span><span class=p>,</span> <span class=mi>182</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mi>241</span><span class=p>,</span> <span class=mi>108</span><span class=p>,</span> <span class=mi>237</span><span class=p>,</span> <span class=mi>190</span><span class=p>,</span> <span class=mi>118</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>155</span><span class=p>,</span> <span class=mi>136</span><span class=p>,</span> <span class=mi>136</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>163</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0xC0</span><span class=p>,</span> <span class=mh>0x0A7</span><span class=p>,</span> <span class=mh>0x0E5</span><span class=p>,</span> <span class=mh>0x0B7</span><span class=p>,</span> <span class=mh>0x3</span><span class=p>,</span> <span class=mh>0x46</span><span class=p>,</span> <span class=mh>0x35</span><span class=p>,</span> <span class=mh>0x26</span><span class=p>,</span> <span class=mh>0x0AE</span><span class=p>,</span> <span class=mh>0x1A</span><span class=p>,</span> <span class=mh>0x37</span><span class=p>,</span> <span class=mh>0x0D4</span><span class=p>,</span> <span class=mh>0x98</span><span class=p>,</span> <span class=mh>0x0DA</span><span class=p>,</span> <span class=mh>0x39</span><span class=p>,</span> <span class=mh>0x17</span><span class=p>,</span> <span class=mh>0x88</span><span class=p>,</span> <span class=mh>0x0E3</span><span class=p>,</span> <span class=mh>0x7D</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0x0F2</span><span class=p>,</span> <span class=mh>0x0AE</span><span class=p>,</span> <span class=mh>0x19</span><span class=p>,</span> <span class=mh>0x49</span><span class=p>,</span> <span class=mh>0x0E</span><span class=p>,</span> <span class=mh>0x0DC</span><span class=p>,</span> <span class=mh>0x0E9</span><span class=p>,</span> <span class=mh>0x36</span><span class=p>,</span> <span class=mh>0x82</span><span class=p>,</span> <span class=mh>0x5F</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>c</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=nb>chr</span><span class=p>(</span><span class=n>rol</span><span class=p>(</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>^</span> <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># amateursCTF{d0n3_4nd_deRust3d}</span>
</span></span></code></pre></td></tr></table></div></div><p>Flag is: <strong>amateursCTF{d0n3_4nd_deRust3d}</strong></p><h2 id=flagchecker>flagchecker</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>flagchecker.sb3</code></li><li><strong>Description:</strong> I was making this simple flag checker in Scratch, but my friend logged into my account and messed up all my variable names. Can you help me recover my flag please? You should run on <a href=https://turbowarp.org/ target=_blank rel="noopener noreffer">Turbowarp</a>
for better performance.</li></ul></div></div></div><p>We are given a scratch file <code>.sb3</code> to work with. I used onine <a href=https://scratch.mit.edu/ target=_blank rel="noopener noreffer">Scratch</a>
to open and edit the code.</p><img src=5.png alt width=1000><p>Looks like the code is obfuscated, and after a while cleaning up, I renamed all the functions to their usages.</p><img src=6.png alt width=1000><p>And the logic was really easy to understand after that, so here is the source code that I rewrote in <code>Python</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>inp</span> <span class=o>=</span> <span class=nb>input</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>inp_ls</span> <span class=o>=</span> <span class=p>[</span><span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>inp</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=nb>len</span><span class=p>(</span><span class=n>inp</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>inp</span><span class=p>[:</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>inp</span><span class=p>[</span><span class=mi>4</span><span class=p>:</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>inp</span> <span class=o>=</span> <span class=n>inp</span><span class=p>[</span><span class=mi>8</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>val</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>+=</span> <span class=mh>0x9E3779B9</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>&amp;=</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=p>(</span><span class=n>u</span> <span class=o>*</span> <span class=mi>16</span> <span class=o>+</span> <span class=mi>69420</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>^=</span> <span class=p>(</span><span class=n>u</span> <span class=o>+</span> <span class=n>val</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>^=</span> <span class=p>(</span><span class=n>u</span> <span class=o>//</span> <span class=mi>32</span> <span class=o>+</span> <span class=mi>1412141</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>+=</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>&amp;=</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=p>(</span><span class=n>t</span> <span class=o>*</span> <span class=mi>16</span> <span class=o>+</span> <span class=mi>1936419188</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>^=</span> <span class=p>(</span><span class=n>t</span> <span class=o>+</span> <span class=n>val</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>^=</span> <span class=p>(</span><span class=n>t</span> <span class=o>//</span> <span class=mi>32</span> <span class=o>+</span> <span class=mi>1953260915</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span> <span class=o>+=</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span> <span class=o>&amp;=</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>res_new</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>res_new</span> <span class=o>=</span> <span class=p>[</span><span class=n>u</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>]</span> <span class=o>+</span> <span class=n>res_new</span>
</span></span><span class=line><span class=cl>        <span class=n>u</span> <span class=o>//=</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>res_new</span> <span class=o>=</span> <span class=p>[</span><span class=n>t</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>]</span> <span class=o>+</span> <span class=n>res_new</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>//=</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>+=</span> <span class=n>res_new</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># print(res)</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>res</span> <span class=o>==</span> <span class=p>[</span><span class=mi>239</span><span class=p>,</span> <span class=mi>202</span><span class=p>,</span> <span class=mi>230</span><span class=p>,</span> <span class=mi>114</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>147</span><span class=p>,</span> <span class=mi>199</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>182</span><span class=p>,</span> <span class=mi>230</span><span class=p>,</span> <span class=mi>119</span><span class=p>,</span> <span class=mi>248</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>246</span><span class=p>,</span> <span class=mi>224</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>99</span><span class=p>,</span> <span class=mi>164</span><span class=p>,</span> <span class=mi>112</span><span class=p>,</span> <span class=mi>134</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>216</span><span class=p>,</span> <span class=mi>53</span><span class=p>,</span> <span class=mi>194</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>223</span><span class=p>,</span> <span class=mi>122</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>202</span><span class=p>,</span> <span class=mi>207</span><span class=p>,</span> <span class=mi>56</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>216</span><span class=p>,</span> <span class=mi>142</span><span class=p>,</span> <span class=mi>248</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>202</span><span class=p>,</span> <span class=mi>119</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>158</span><span class=p>,</span> <span class=mi>232</span><span class=p>,</span> <span class=mi>251</span><span class=p>,</span> <span class=mi>201</span><span class=p>,</span> <span class=mi>158</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>242</span><span class=p>,</span> <span class=mi>193</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>191</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>38</span><span class=p>,</span> <span class=mi>164</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>To solve that, I wrote another script to start working backwards.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=p>[</span><span class=mi>239</span><span class=p>,</span> <span class=mi>202</span><span class=p>,</span> <span class=mi>230</span><span class=p>,</span> <span class=mi>114</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>147</span><span class=p>,</span> <span class=mi>199</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>182</span><span class=p>,</span> <span class=mi>230</span><span class=p>,</span> <span class=mi>119</span><span class=p>,</span> <span class=mi>248</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>246</span><span class=p>,</span> <span class=mi>224</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>99</span><span class=p>,</span> <span class=mi>164</span><span class=p>,</span> <span class=mi>112</span><span class=p>,</span> <span class=mi>134</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>216</span><span class=p>,</span> <span class=mi>53</span><span class=p>,</span> <span class=mi>194</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>223</span><span class=p>,</span> <span class=mi>122</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>202</span><span class=p>,</span> <span class=mi>207</span><span class=p>,</span> <span class=mi>56</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>216</span><span class=p>,</span> <span class=mi>142</span><span class=p>,</span> <span class=mi>248</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>202</span><span class=p>,</span> <span class=mi>119</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>158</span><span class=p>,</span> <span class=mi>232</span><span class=p>,</span> <span class=mi>251</span><span class=p>,</span> <span class=mi>201</span><span class=p>,</span> <span class=mi>158</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>242</span><span class=p>,</span> <span class=mi>193</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>191</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>96</span><span class=p>,</span> <span class=mi>38</span><span class=p>,</span> <span class=mi>164</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ls</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>val</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>val</span> <span class=o>+=</span> <span class=mh>0x9E3779B9</span>
</span></span><span class=line><span class=cl>    <span class=n>val</span> <span class=o>&amp;=</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>    <span class=n>ls</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ls</span> <span class=o>=</span> <span class=n>ls</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>),</span> <span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>+</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>+</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>*</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>    <span class=n>u</span> <span class=o>=</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>7</span><span class=p>]</span> <span class=o>+</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>6</span><span class=p>]</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>+</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>5</span><span class=p>]</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>+</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>4</span><span class=p>]</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>*</span> <span class=mi>256</span> <span class=o>*</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=p>(</span><span class=n>t</span> <span class=o>*</span> <span class=mi>16</span> <span class=o>+</span> <span class=mi>1936419188</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>^=</span> <span class=p>(</span><span class=n>t</span> <span class=o>+</span> <span class=n>ls</span><span class=p>[</span><span class=n>_</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>^=</span> <span class=p>(</span><span class=n>t</span> <span class=o>//</span> <span class=mi>32</span> <span class=o>+</span> <span class=mi>1953260915</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tmp</span> <span class=o>&gt;</span> <span class=n>u</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>=</span> <span class=mh>0xFFFFFFFF</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>-</span> <span class=p>(</span><span class=n>tmp</span> <span class=o>-</span> <span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>=</span> <span class=n>u</span> <span class=o>-</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=p>(</span><span class=n>u</span> <span class=o>*</span> <span class=mi>16</span> <span class=o>+</span> <span class=mi>69420</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>^=</span> <span class=p>(</span><span class=n>u</span> <span class=o>+</span> <span class=n>ls</span><span class=p>[</span><span class=n>_</span><span class=p>])</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>^=</span> <span class=p>(</span><span class=n>u</span> <span class=o>//</span> <span class=mi>32</span> <span class=o>+</span> <span class=mi>1412141</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xFFFFFFFF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tmp</span> <span class=o>&gt;</span> <span class=n>t</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>t</span> <span class=o>=</span> <span class=mh>0xFFFFFFFF</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>-</span> <span class=p>(</span><span class=n>tmp</span> <span class=o>-</span> <span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>t</span> <span class=o>=</span> <span class=n>t</span> <span class=o>-</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>end</span><span class=o>=</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>u</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># amateursCTF{screw_scratch_llvm_we_code_by_hand_1a89c87b}</span>
</span></span></code></pre></td></tr></table></div></div><p>Flag is: <strong>amateursCTF{screw_scratch_llvm_we_code_by_hand_1a89c87b}</strong></p><h2 id=heading>üè¥‚ùìüá®üáπüá´</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given file:</strong> <code>emojis.tar.gz</code></li><li><strong>Description:</strong> I apologize in advance. Flag is <code>amateursCTF{[a-z0-9_]+}</code>. Compiled using the latest version of <code>emojicode</code>. Note that there may be multiple inputs that cause the program to print ‚úÖ. The correct input (and the flag) has sha256 hash <code>53cf379fa8fd802fd2f99b2aa395fe8b19b066ab5e2ff49e44633ce046c346c4</code>.</li></ul></div></div></div><p>We are given a source written in <code>emojicode</code>. After a while researching the <a href=https://www.emojicode.org/docs/guides target=_blank rel="noopener noreffer">emojicode docs</a>
, I managed to rewrite the source code using <code>Python</code>, as below.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>egg</span> <span class=o>=</span> <span class=p>[[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[]]</span>
</span></span><span class=line><span class=cl><span class=n>bacon</span> <span class=o>=</span> <span class=p>[[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[],</span> <span class=p>[]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=nb>input</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>inp</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>inp</span> <span class=o>+=</span> <span class=nb>bin</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>))[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>inp</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>256</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Wrong&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>inp</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>inp</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>egg</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mi>16</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>egg</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mi>16</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>egg</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mi>16</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>bacon</span><span class=p>[</span><span class=n>i</span> <span class=o>//</span> <span class=mi>16</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bacon</span><span class=p>[</span><span class=n>i</span> <span class=o>//</span> <span class=mi>16</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>bacon</span><span class=p>[</span><span class=n>i</span> <span class=o>//</span> <span class=mi>16</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>egg</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mi>16</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>egg</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mi>16</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>egg</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mi>16</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>bacon</span><span class=p>[</span><span class=n>i</span> <span class=o>//</span> <span class=mi>16</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>bacon</span><span class=p>[</span><span class=n>i</span> <span class=o>//</span> <span class=mi>16</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bacon</span><span class=p>[</span><span class=n>i</span> <span class=o>//</span> <span class=mi>16</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>egg</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>egg</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>egg</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>egg</span><span class=p>[</span><span class=n>i</span><span class=p>][:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>bacon</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>bacon</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>bacon</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>bacon</span><span class=p>[</span><span class=n>i</span><span class=p>][:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>chicken</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>           <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span>
</span></span><span class=line><span class=cl>           <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pig</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>       <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>7</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>chicken</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>egg</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>pig</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>bacon</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>res</span> <span class=o>==</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Correct&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Wrong&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># print(egg)</span>
</span></span><span class=line><span class=cl><span class=c1># print(bacon)</span>
</span></span></code></pre></td></tr></table></div></div><p>So our problem now becomes easier, just need to know how <code>egg[]</code> and <code>bacon[]</code> are generated. And that took me quite some time to realize that this is implementing the game <a href=https://www.puzzle-nonograms.com/ target=_blank rel="noopener noreffer">nonogram</a>
, where <code>chicken[]</code> contains rules for columns and <code>pig[]</code> contains rules for rows.</p><p>There are plenty of nonogram solvers online, but I chose to solve this manually (really enjoyed it xD). Here is the final solution:</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>Solution<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>1100001110110111</p><p>0000111101001100</p><p>1011110101111001</p><p>0111001110000111</p><p>0101001000110111</p><p>1011110111110100</p><p>0110100111100111</p><p>0111111100010110</p><p>0101110110011011</p><p>1111011101100111</p><p>1110011101111111</p><p>0100111011101110</p><p>0111100011100100</p><p>1100101101111111</p><p>0110111010011101</p><p>0111000111111101</p></div></div></div><p>Then the only thing left is to convert it into readable characters. Here, since our characters might have either <code>6</code> or <code>7</code> bits, so we need to do some trials and errors to get it. (<code>6</code> bits for numbers and <code>7</code> bits for any other characters of the regex in the description).</p><p>I didn&rsquo;t need to use the <code>sha256</code> hash because the flag was easy to read!</p><p>Flag is: <strong>amateursCTF{7his_belongs_ins1de_mi5c}</strong></p><h2 id=jsrev>jsrev</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li><strong>Given link:</strong> <code>jsrev.amt.rs</code></li><li><strong>Description:</strong> Someone wanted this, so I delivered. Have fun!</li></ul></div></div></div><p>We are given a game written in <code>js</code>.</p><img src=7.png alt width=1000><p>From <code>index.js</code>, I saw this <code>loader.load( 'collision-world.glb', ( gltf )</code> and tried to view the <code>3D</code> model of the map but found nothing.</p><img src=9.png alt width=1000><p>Then I saw this line <code>const GRAVITY = 30;</code>, and thought about why not just modify it to <code>0</code> to fly around?</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>How to modify js locally<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Here is a great tutorial for doing that: <a href="https://www.youtube.com/watch?v=i7Sdq4av8d4&amp;t" target=_blank rel="noopener noreffer">Click me!</a></div></div></div><p>After modified the <code>GRAVITY</code> variable to <code>0</code>, I flew up using right click (it works like a jetpack) and saw the balls are stacked above in the sky. Take a closer look, I recognized that it is showing our characters of the flag, in a stack.</p><img src=8.png alt width=1000><p>It got more obvious when I saw this line <code>await fetch('./coords.json')</code> and that is where the coordinates of the balls are saved.</p><p>I tried to plot them in <code>Python</code> using below script.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>axes</span><span class=p>(</span><span class=n>projection</span><span class=o>=</span><span class=s1>&#39;3d&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ls</span> <span class=o>=</span> <span class=p>[[</span><span class=mf>4.2</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mf>10.6</span><span class=p>],</span> <span class=p>[</span><span class=mf>4.2</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mf>11.0</span><span class=p>],</span> <span class=p>[</span><span class=o>...</span><span class=p>],</span> <span class=p>[</span><span class=mf>5.4</span><span class=p>,</span> <span class=mf>34.4</span><span class=p>,</span> <span class=mf>11.0</span><span class=p>],</span> <span class=p>[</span><span class=mf>5.8</span><span class=p>,</span> <span class=mf>34.4</span><span class=p>,</span> <span class=mf>10.6</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>472</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>ls</span><span class=p>][</span><span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span><span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=p>[</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>ls</span><span class=p>][</span><span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span><span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=p>[</span><span class=n>i</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>ls</span><span class=p>][</span><span class=n>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span><span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span><span class=p>,</span> <span class=s1>&#39;green&#39;</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>At first, set <code>a</code> in the script to <code>(0, 472)</code> is really hard (impossible) to read the flag, so I tried to output the points in subgroups (ex. <code>(0, 50)</code>, <code>(50, 100)</code>, &mldr;).</p><p>Here is the output if we set <code>a</code> in the script to <code>(0, 15)</code>, which reveals letter <code>a</code>.</p><img src=10.png alt width=1000><p>And, here is the output if we set <code>a</code> in the script to <code>(15, 30)</code>, which reveals letter <code>m</code>.</p><img src=11.png alt width=1000><p>We will eventually get the flag after a while!</p><p>Flag is: <strong>amateursCTF{asK_4nD_thr33_5h4ll_r3c31v3}</strong></p><h2 id=appendix>Appendix</h2><p>The challenges were quite fun to solve, some of them were written in uncommon languages, which I think is really cool!</p><p>If you have any question regarding the above solutions, you can DM me via my <a href=https://twitter.com/FazeCT1512 target=_blank rel="noopener noreffer">Twitter</a>
or my <code>Discord</code> (FazeCT #fazect).</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-07-20</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/amateursctf2023-rev/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://fazect.github.io/amateursctf2023-rev/ data-title="amateursCTF 2023 - Reverse Engineering Writeups" data-hashtags=RE,amateursCTF,english><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://fazect.github.io/amateursctf2023-rev/ data-hashtag=RE><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://fazect.github.io/amateursctf2023-rev/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/re/>RE</a>,&nbsp;<a href=/tags/amateursctf/>amateursCTF</a>,&nbsp;<a href=/tags/english/>english</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/zer0ptsctf2023-rev/ class=prev rel=prev title="zer0ptsCTF 2023 - Reverse Engineering Writeups"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>zer0ptsCTF 2023 - Reverse Engineering Writeups</a>
<a href=/imaginaryctf2023-rev/ class=next rel=next title="ImaginaryCTF 2023 - Reverse Engineering Writeups">ImaginaryCTF 2023 - Reverse Engineering Writeups<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.115.4">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://fazect.github.io/ target=_blank>FazeCT</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>